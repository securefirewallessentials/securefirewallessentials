(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var i=n(0),o=n.n(i);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),p=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},b=function(e){var t=p(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},d=o.a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,r=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),b=p(n),d=i,m=b["".concat(r,".").concat(d)]||b[d]||u[d]||a;return n?o.a.createElement(m,s(s({ref:t},l),{},{components:n})):o.a.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,r=new Array(a);r[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var l=2;l<a;l++)r[l]=n[l];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},298:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image2-a804dc7a6f91b8c48b0f01a2a319f970.png"},299:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image3-d60a78f5f849e78a54761aab343282f5.png"},300:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image4-6e33c504a58a18ceb89837523e87ad9b.png"},301:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image5-589649b087e5bd82dfaccbe54020dc78.png"},302:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image6-badc1b56ef2aff77d3ac59a9a04469f0.png"},303:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image7-9da4bc993188e8e67ab42c8e69839c04.png"},304:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image8-dc62e69aba791c03855ab5900525fb43.png"},305:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image9-4a1da3055a81089403f23eda17439236.png"},306:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image10-49d70df968c5e70c6d651fd415d8af03.png"},307:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image11-a59ba6b578d564b499e0479369aed0d0.png"},96:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return b}));var i=n(3),o=n(7),a=(n(0),n(101)),r=["components"],s={id:"intrusion-policy",title:"Intrusion Policy",description:"Configuring the Intrusion Policy on the FMC",hide_table_of_contents:!1},c={unversionedId:"intrusion-policy",id:"intrusion-policy",isDocsHomePage:!1,title:"Intrusion Policy",description:"Configuring the Intrusion Policy on the FMC",source:"@site/docs/FMC_IntrusionP.md",slug:"/intrusion-policy",permalink:"/securefirewallessentials/docs/intrusion-policy",editUrl:"https://securefirewallessentials.github.io/docs/FMC_IntrusionP.md",version:"current",sidebar:"firstSidebar",previous:{title:"File and Malware Policy",permalink:"/securefirewallessentials/docs/file-policy"},next:{title:"SSL Policy",permalink:"/securefirewallessentials/docs/ssl-policy"}},l=[{value:"Introduction",id:"introduction",children:[]},{value:"Intrusion Policy",id:"intrusion-policy",children:[]},{value:"Configuration",id:"configuration",children:[{value:"Network Analysis Policy Configuration",id:"network-analysis-policy-configuration",children:[]},{value:"Intrusion Policy Configuration",id:"intrusion-policy-configuration",children:[]},{value:"Variables Set Configuration",id:"variables-set-configuration",children:[]},{value:"Access Control Policy Configuration",id:"access-control-policy-configuration",children:[]},{value:"Taking Advantage of Firepower Recommendations",id:"taking-advantage-of-firepower-recommendations",children:[]}]},{value:"Verification/Troubleshooting",id:"verificationtroubleshooting",children:[]},{value:"Summary",id:"summary",children:[]},{value:"Additional Resources",id:"additional-resources",children:[]}],p={toc:l};function b(e){var t=e.components,s=Object(o.a)(e,r);return Object(a.b)("wrapper",Object(i.a)({},p,s,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"May 22, 2021"),Object(a.b)("h2",{id:"introduction"},"Introduction"),Object(a.b)("p",null,"This document discusses the key components of Cisco Firepower system's\nintrusion detection and prevention feature and best practices for\nconfiguration."),Object(a.b)("h2",{id:"intrusion-policy"},"Intrusion Policy"),Object(a.b)("p",null,"An intrusion policy consists of a defined set of intrusion detection and\nprevention configurations that inspect traffic for security violations\nand, in inline deployments, can block or alter malicious traffic. An\naccess control policy invokes intrusion policies and is the system's\nlast line of defense before traffic is allowed to its destination."),Object(a.b)("h2",{id:"configuration"},"Configuration"),Object(a.b)("p",null,"The efficacy of Cisco Firepower Threat Defense (FTD) does not solely\ndepend on an intrusion policy. To provide deep packet inspection and\nprotect against network traffic, a Firepower system combines several\ncomponents, including the network analysis, intrusion, and access\ncontrol policies, and variable sets."),Object(a.b)("p",null,"Network analysis and intrusion policies work together as part of the\nFirepower system's intrusion detection and prevention feature. A parent\naccess control policy invokes both network analysis and intrusion\npolicies but at different times. As the system analyzes traffic, the\nnetwork analysis (decoding and preprocessing) phase occurs before and\nseparately from the intrusion prevention (additional preprocessing and\nintrusion rules) phase."),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"A network analysis policy (NAP) governs how traffic is decoded and\npreprocessed for further evaluation, especially for anomalous\ntraffic that might signal an intrusion attempt.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"An intrusion policy uses intrusion and preprocessor rules (sometimes\nreferred to collectively as intrusion rules) to examine the decoded\npackets for attacks based on patterns. Intrusion policies are also\npaired with variable sets that use named values to reflect a network\nenvironment accurately."))),Object(a.b)("h3",{id:"network-analysis-policy-configuration"},"Network Analysis Policy Configuration"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Policies ",">"," Access Control")," and then choose\n",Object(a.b)("strong",{parentName:"p"},"Network Analysis Policy"),". The ",Object(a.b)("strong",{parentName:"p"},"Network Analysis Policy")," page is\nalso accessible from the ",Object(a.b)("strong",{parentName:"p"},"Policies ",">"," Access Control ",">"," Intrusion"),"\nwindow."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": Click ",Object(a.b)("strong",{parentName:"p"},"Create Policy"),". The ",Object(a.b)("strong",{parentName:"p"},"Create Network Analysis\nPolicy")," window displays."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Create NAP Policy",src:n(298).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 1:")," Creation of Network Analysis Policy with Balanced Security and\nConnectivity as the Base Policy"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 3"),": Enter a unique ",Object(a.b)("strong",{parentName:"p"},"Name"),". Optionally, enter a\n",Object(a.b)("strong",{parentName:"p"},"Description"),"."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 4"),": Choose an initial ",Object(a.b)("strong",{parentName:"p"},"Base Policy"),". Start with a base policy\nthat reflects the company's security posture. As a general\nrecommendation, if choosing the ",Object(a.b)("strong",{parentName:"p"},"Balanced Security and Connectivity"),"\nas the base policy for the intrusion policy, also choose the ",Object(a.b)("strong",{parentName:"p"},"Balanced\nSecurity and Connectivity")," in the Network Analysis policy."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 5"),": To allow preprocessors to affect traffic in an inline\ndeployment, enable ",Object(a.b)("strong",{parentName:"p"},"Inline Mode"),"."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 6"),": Click ",Object(a.b)("strong",{parentName:"p"},"Create Policy")," to create a new policy and then\nreturn to the ",Object(a.b)("strong",{parentName:"p"},"Network Analysis Policy")," window. This new policy has\nthe same settings as its base policy. Click the ",Object(a.b)("strong",{parentName:"p"},"Create and Edit\nPolicy")," option to create a policy and open it for editing in the Policy\nEditor."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 7"),": If the deployment is inline, enable the ",Object(a.b)("strong",{parentName:"p"},"Inline\nNormalization")," preprocessor by editing the ",Object(a.b)("strong",{parentName:"p"},"Network Analysis Policy"),".\nThe options to enable or disable preprocessors are located in the\n",Object(a.b)("strong",{parentName:"p"},"Settings")," window."),Object(a.b)("p",null,Object(a.b)("img",{alt:"NAP Policy",src:n(299).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 2:")," Enablement of Inline Normalization"),Object(a.b)("h3",{id:"intrusion-policy-configuration"},"Intrusion Policy Configuration"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Policies")," ",">"," ",Object(a.b)("strong",{parentName:"p"},"Access Control")," ",">"," ",Object(a.b)("strong",{parentName:"p"},"Intrusion"),"."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": Click ",Object(a.b)("strong",{parentName:"p"},"Create Policy"),". The ",Object(a.b)("strong",{parentName:"p"},"Create Intrusion Policy"),"\nwindow displays."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Create Intrusion Policy",src:n(300).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 3:")," Creation of Intrusion Policy with Balanced Security and\nConnectivity as the Base Policy"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 3"),": Enter a unique ",Object(a.b)("strong",{parentName:"p"},"Name"),". Optionally, enter a\n",Object(a.b)("strong",{parentName:"p"},"Description"),"."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 4"),": Set the drop behavior of the intrusion policy using the\n",Object(a.b)("strong",{parentName:"p"},"Drop when Inline")," option. This option instructs FTD how to work with\nthe intrusion or preprocessor rules whose rule states are set to ",Object(a.b)("strong",{parentName:"p"},"Drop\nand Generate Events"),". Check the ",Object(a.b)("strong",{parentName:"p"},"Drop when Inline")," checkbox to allow\nintrusion rules to affect traffic and generate events. Unchecking the\n",Object(a.b)("strong",{parentName:"p"},"Drop when Inline")," checkbox instructs the intrusion rules from\naffecting traffic while still generating events. Enable drop behavior in\ninline deployments to drop malicious packets."),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"In passive deployments, the system cannot affect traffic flow\nregardless of the drop behavior."))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 5"),": Choose an initial Base Policy. Choose either a\nsystem-provided policy or create a custom policy as a base policy. The\nmost common approach is to start with ",Object(a.b)("strong",{parentName:"p"},"Balanced Security and\nConnectivity")," policy and modify that as needed."),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"The primary metric used to select intrusion rules for a\nparticular base policy is the Common Vulnerability Scoring System (CVSS)\nscore. A CVSS score is assigned to each vulnerability that might be\ncovered by an intrusion rule. Other considerations exist, such as the\nage of a particular vulnerability and threat coverage by a rule. For\nexample, SQL Injection rules are considered to be significant enough to\nhave influence when being considered for policy inclusion. The\nrecommended ",Object(a.b)("strong",{parentName:"p"},"Balanced Security and Connectivity")," base policy addresses\nvulnerabilities with CVSS scores of 9 or greater from the last two years\n(such as the current year, previous year, and the year before last\nyear)."))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 6"),": Click ",Object(a.b)("strong",{parentName:"p"},"Create Policy")," to create the new policy and then\nreturn to the ",Object(a.b)("strong",{parentName:"p"},"Intrusion Policy")," window. This new policy has the same\nsettings as its base policy. Click ",Object(a.b)("strong",{parentName:"p"},"Create and Edit Policy")," to create\nthe policy and open it for editing in the advanced Intrusion Policy\nEditor."),Object(a.b)("h3",{id:"variables-set-configuration"},"Variables Set Configuration"),Object(a.b)("p",null,"Variable sets provide greater detection accuracy and reduce the amount\nof noise. Whenever the system uses an intrusion policy to evaluate\ntraffic, it uses an associated variable set. Variables in a set\nrepresent values commonly used in intrusion rules to identify the source\nand destination IP addresses and ports. To create or modify variable\nsets:"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Objects")," ",">"," ",Object(a.b)("strong",{parentName:"p"},"Object Management"),". The ",Object(a.b)("strong",{parentName:"p"},"Object\nManager")," window displays."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": Click ",Object(a.b)("strong",{parentName:"p"},"Variable Sets")," in the left panel. The page lists\nthe default variable set and any custom sets if created."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Variable Sets",src:n(301).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 4:")," Editing a Variable Set"),Object(a.b)("p",null,"Initially, the Firepower system provides a single, default variable set\ncomprised of predefined default values. Each variable in the default set\nis initially set to its default value. Most of the shared object rules\nand standard text rules provided by the Firepower system use predefined\ndefault variables to define networks and port numbers. For example, most\nof the rules use the variable \\$HOME_NET to specify the protected\nnetwork and the variable \\$EXTERNAL_NET to specify the unprotected (or\noutside) network. Also, specialized rules often use other predefined\nvariables. For example, rules that detect exploits against web servers\nuse the \\$HTTP_SERVERS and \\$HTTP_PORTS variables."),Object(a.b)("p",null,"The following are some of the best practices to consider when\nconfiguring variable sets:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Rules are more effective when variables reflect a network\nenvironment more accurately. At a minimum, consider modifying\ndefault variables in the default set to accurately reflect the\nnetwork environment where the Firepower system is deployed. For\nexample, include the IP addresses and ports of your web servers in\nthe \\$HTTP_SERVERS and \\$HTTP_PORTS variables.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Change the value from 'any' to a specific address. By ensuring that\na variable such as \\$HOME_NET correctly defines an internal network\nand \\$HTTP_SERVERS includes all web servers on a network. It\noptimizes processor utilization and enables accurate monitoring of\nall relevant systems for suspicious activity.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Defines the specialized variables with more specific and realistic\nvalues. For example, \\$EXTERNAL_NET variable should exclude the\n\\$HOME_NET.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Making the variable sets overly complicated to increase efficiency\nalso increases the possibility of missing traffic entirely. Use CIDR\nblocks to reduce this size or number of entries in a variable. Opt\nfor fewer variable sets with broader network ranges. For example,\nuse the RFC-1918 ranges into \\$HOME_NET uses only three entries."))),Object(a.b)("h3",{id:"access-control-policy-configuration"},"Access Control Policy Configuration"),Object(a.b)("p",null,"Upon completion of the configuration of all the components described in\nthe previous sections, invoke them into an Access Control Policy. Within\nan Access Control Policy, access control rules provide a granular method\nof handling network traffic across multiple managed devices. The system\nmatches traffic to access control rules in the order it is specified. In\nmost cases, the system handles network traffic according to the first\naccess control rule, where all the rule's conditions match the traffic."),Object(a.b)("p",null,"To associate the desired intrusion policy with an access rule, complete\nthe following steps:"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Policies")," ",">"," ",Object(a.b)("strong",{parentName:"p"},"Access Control"),". The list of\nAccess Control Policies displays. Either edit an existing policy or\ncreate a new one by clicking ",Object(a.b)("strong",{parentName:"p"},"New Policy"),"."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Access Control Policy",src:n(302).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 5:")," New Policy Button on the Access Policy Page"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": In the ",Object(a.b)("strong",{parentName:"p"},"Access Control Policy Editor")," window, choose an\nexisting access rule or create a new rule by clicking ",Object(a.b)("strong",{parentName:"p"},"Add Rule"),"."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 3"),": In the ",Object(a.b)("strong",{parentName:"p"},"Access Rule Editor")," window, choose the\n",Object(a.b)("strong",{parentName:"p"},"Inspection")," tab. Select the desired intrusion policy and variable set\nusing the drop-down menu. By default, the default variable set is linked\nto all intrusion policies used by access control policies."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Access Rule",src:n(303).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 6:")," Inspection Tab on the Add Rule Editor Allows an Administrator\nto Associate an Intrusion Policy with an Access Rule"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 5"),": Click ",Object(a.b)("strong",{parentName:"p"},"Add")," in the ",Object(a.b)("strong",{parentName:"p"},"Rule Editor")," window. The ",Object(a.b)("strong",{parentName:"p"},"Access\nPolicy Editor")," window redisplays."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 6"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Balanced Security and Connectivity")," as the\n",Object(a.b)("strong",{parentName:"p"},"Default Action")," policy. This policy ensures the inspection of traffic\nthat does not meet the conditions of any access control rules."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Base Policy",src:n(304).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 7:")," Default Action of an Access Control Policy"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 7"),": Click ",Object(a.b)("strong",{parentName:"p"},"Save")," to save the changes in the Access Control\npolicy."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 8"),": Finally, choose ",Object(a.b)("strong",{parentName:"p"},"Deploy ",">"," Deployment")," to deploy the\nrevised policy to the desired FTD devices to activate the new intrusion\npolicy."),Object(a.b)("h3",{id:"taking-advantage-of-firepower-recommendations"},"Taking Advantage of Firepower Recommendations"),Object(a.b)("p",null,"Firepower Recommendations uses the data passively collected for host\nprofiling about the operating systems, servers, and client applications\nwithin the environment and then associates specific rules to protect\nthese assets. Some organizations also run Firepower Recommendations\nafter bringing new service online and incorporate this step into the\nchange management process. To generate Firepower Recommendations,\ncomplete the following steps:"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Edit the desired Intrusion Policy. The ",Object(a.b)("strong",{parentName:"p"},"Intrusion Policy\nEditor")," window displays."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Firepower Recommendations")," in the left panel."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 3"),": Click ",Object(a.b)("strong",{parentName:"p"},"Generate Recommendations")," to generate\nrecommendations only, or click the ",Object(a.b)("strong",{parentName:"p"},"Generate and Use Recommendations"),"\noption to incorporate the recommendations upon generation. It is a good\nidea to run Firepower Recommendations regularly (monthly, quarterly) to\nensure that the rule set in the intrusion policy is always optimized."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Firepower Recommendations",src:n(305).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 8:")," Firepower Recommendations page within an Intrusion Policy\nEditor"),Object(a.b)("p",null,Object(a.b)("img",{alt:"Firepower Recommendations",src:n(306).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 9:")," Firepower Recommendation Page (After Generating Recommendation)"),Object(a.b)("h2",{id:"verificationtroubleshooting"},"Verification/Troubleshooting"),Object(a.b)("p",null,"To assess how an intrusion policy would function in an inline deployment\n(that is, where relevant configurations are deployed to devices using\nrouted, switched, or transparent interfaces, or inline interface pairs)\nwithout affecting traffic, disable the drop behavior. The options to not\ndrop traffic include passive, inline tap mode, or inline mode with the\n",Object(a.b)("strong",{parentName:"p"},"Drop when Inline")," option unchecked. The option is found on the\n",Object(a.b)("strong",{parentName:"p"},"Policy Information")," window when creating a new intrusion policy (see\nFigure 3) and customizable in an existing intrusion policy. In this\ncase, the system generates intrusion events but does not drop packets\nthat trigger drop rules. If the result meets expectations, enable drop\nbehavior with confidence; this ensures that the policy is further\noptimized before moving the ruleset into production."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Verify Intrusion Policy",src:n(307).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 10:")," Drop when Inline Option within an Intrusion Policy"),Object(a.b)("p",null,"For additional information on troubleshooting an intrusion policy in\nvarious phases of the traffic inspection, refer to the following\narticle:\n",Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/214609-firepower-data-path-troubleshooting-phas.html"},"https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/214609-firepower-data-path-troubleshooting-phas.html")),Object(a.b)("h2",{id:"summary"},"Summary"),Object(a.b)("p",null,"Intrusion prevention systems play a vital role in protecting a network\nfrom threats. Therefore, keep intrusion policies updated with a new\nruleset is always critical. Cisco Talos releases new intrusion rules\nregularly. Leverage the latest signatures and update the system\nregularly to ensure security effectiveness to a Cisco Firepower system.\nTo learn how to schedule automatic update on a Firepower system, refer\nto the following:\n",Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/task_scheduling.html"},"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/task_scheduling.html")),Object(a.b)("h2",{id:"additional-resources"},"Additional Resources"),Object(a.b)("p",null,"To learn more about the Cisco Firepower Next-Generation Intrusion\nPrevention System (NGIPS), read the following publications:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("a",{parentName:"p",href:"http://www.ciscopress.com/title/9781587144806"},"http://www.ciscopress.com/title/9781587144806"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/overview_of_network_analysis_and_intrusion_policies.html"},"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/overview_of_network_analysis_and_intrusion_policies.html"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/214609-firepower-data-path-troubleshooting-phas.html"},"https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/214609-firepower-data-path-troubleshooting-phas.html"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/214405-what-are-the-metrics-used-to-determine-t.html"},"https://www.cisco.com/c/en/us/support/docs/security/firepower-ngfw/214405-what-are-the-metrics-used-to-determine-t.html")))))}b.isMDXComponent=!0}}]);