<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/securefirewallessentials/blog/rss.xml" title="Secure Firewall Essentials Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/securefirewallessentials/blog/atom.xml" title="Secure Firewall Essentials Blog Atom Feed"><title data-react-helmet="true">Access Control Policy | Secure Firewall Essentials</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Access Control Policy | Secure Firewall Essentials"><meta data-react-helmet="true" name="description" content="Configuring the Access Control Policy on the FMC"><meta data-react-helmet="true" property="og:description" content="Configuring the Access Control Policy on the FMC"><meta data-react-helmet="true" property="og:url" content="https://securefirewallessentials.github.io/securefirewallessentials/docs/access-control-policy"><link data-react-helmet="true" rel="shortcut icon" href="/securefirewallessentials/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://securefirewallessentials.github.io/securefirewallessentials/docs/access-control-policy"><link rel="stylesheet" href="/securefirewallessentials/styles.a0ebc7b8.css">
<link rel="preload" href="/securefirewallessentials/styles.a4842356.js" as="script">
<link rel="preload" href="/securefirewallessentials/runtime~main.f1b07267.js" as="script">
<link rel="preload" href="/securefirewallessentials/main.198f0307.js" as="script">
<link rel="preload" href="/securefirewallessentials/1.daadf3d3.js" as="script">
<link rel="preload" href="/securefirewallessentials/30.7c88bcd9.js" as="script">
<link rel="preload" href="/securefirewallessentials/31.d754188b.js" as="script">
<link rel="preload" href="/securefirewallessentials/935f2afb.5904cdef.js" as="script">
<link rel="preload" href="/securefirewallessentials/29.57805d62.js" as="script">
<link rel="preload" href="/securefirewallessentials/7d74e1b1.e5dc3d2b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/securefirewallessentials/"><img src="/securefirewallessentials/img/logo.svg" alt="NetSec Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/securefirewallessentials/img/logo.svg" alt="NetSec Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Secure Firewall Essentials</strong></a><a class="navbar__item navbar__link" href="/securefirewallessentials/docs/">Docs</a><a class="navbar__item navbar__link" href="/securefirewallessentials/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/securefirewallessentials/"><img src="/securefirewallessentials/img/logo.svg" alt="NetSec Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/securefirewallessentials/img/logo.svg" alt="NetSec Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Secure Firewall Essentials</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/securefirewallessentials/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/securefirewallessentials/blog">Blog</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">FMC Best Practices</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/securefirewallessentials/docs/">Smart Licensing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/securefirewallessentials/docs/discovery-policy">Discovery Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/securefirewallessentials/docs/file-policy">File and Malware Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/securefirewallessentials/docs/intrusion-policy">Intrusion Policy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/securefirewallessentials/docs/ssl-policy">SSL Policy</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/securefirewallessentials/docs/access-control-policy">Access Control Policy</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/securefirewallessentials/docs/snmp">SNMP Monitoring</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/securefirewallessentials/docs/vrf">Virtual Routing and Forwarding</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">White Papers</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/securefirewallessentials/docs/sips-wp">Secure IPS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Glossary</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/securefirewallessentials/docs/glossary">Secure Firewall Glossary</a></li></ul></li></ul></div><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_2WRA"><svg width="20" height="20" role="img" class="collapseSidebarButtonIcon_CoMu"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Access Control Policy</h1></header><div class="markdown"><p>May 22, 2021</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>This document discusses the Firepower System&#x27;s Access Control feature&#x27;s
key components and the configuration best practices using a sample
scenario. Configuration steps are based on Cisco Firepower Management
Center v6.6.1, which may differ slightly from previous versions.Â </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="background-information"></a>Background Information<a class="hash-link" href="#background-information" title="Direct link to heading">#</a></h2><p>One of the essential functions of a firewall is to provide access
control by determining which network connections enter your network from
the outside or leave your network from the inside. The specifics of what
should and should not be permitted are beyond this document&#x27;s scope as
each network has unique requirements. However, we will provide some best
practice guidance on structuring your access policy to protect against
malicious activity.</p><p>This document focuses on the Access Control policy only. Separate guides
are available that cover other policies associated with the access
control policy, such as Network Discovery, Intrusion Prevention (IPS),
File and Malware.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="access-control"></a>Access Control<a class="hash-link" href="#access-control" title="Direct link to heading">#</a></h2><p>Access Control policies are just one part of the Firepower Threat
Defense (FTD) feature set that organizations use to control network
traffic. As packets ingress the firewall, many checks occur. For
example, for the packet part of an existing connection, does the packet
require decryption or network address translation? Once the packet has
had these checks applied, it passes into the Access Control Policy
(ACP).</p><p>An ACP can be assigned to one or more managed devices. However, a device
can only have one ACP deployed at one time. The benefit of assigning a
single ACP to more than one device is that a single change to the policy
via the FMC UI can be applied to multiple devices quickly, reducing
operational overhead.</p><p>Network data that is processed by managed devices can be filtered and
controlled by a set of rules based on:</p><ul><li><p>simple, easily determined transport and network layer
characteristics: source and destination, ports, protocols and
applications</p></li><li><p>the latest contextual information on the traffic, including
characteristics such as reputation, risk, business relevance, the
application used, or URL visited</p></li><li><p>realm, user, user group, or ISE attribute</p></li><li><p>custom Security Group Tag (SGT)</p></li><li><p>characteristics of encrypted traffic; you can also decrypt this
traffic for further analysis</p></li><li><p>whether unencrypted or decrypted traffic contains a prohibited file,
detected malware, or intrusion attempt</p></li><li><p>time and day</p></li></ul><p>Each rule within an access policy requires an associated action
determining how to handle the traffic that matches a rule. <em>Figure
1</em> below details the various rule actions. Additional properties
define how to record the activity in the form of logs or alerts.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="access-control-policy-processing"></a>Access Control Policy Processing<a class="hash-link" href="#access-control-policy-processing" title="Direct link to heading">#</a></h3><p>When processing network connections, the firewall matches traffic
against the ACP rules in the order they are specified. Typically, rule
processing is top-down, starting with the policy&#x27;s first rule and
matching against an access control rule when traffic meets all of the
rule&#x27;s conditions.</p><p><img alt="AC Rule Processing" src="/securefirewallessentials/assets/images/image1-f1271a3708c0b3ec1141bd65b163c129.png"></p><p><strong>Figure 1:</strong> Access Control Policy rule processing</p><p><em>Figure 1</em> highlights traffic evaluation as it traverses the
firewall. In this example, traffic is evaluated as follows:</p><ul><li><p><strong>Rule 1: Monitor</strong> evaluates traffic first to track and log network
traffic. The system continues to match traffic against additional
rules to determine whether to permit or deny it.</p></li><li><p><strong>Rule 2: Trust</strong> evaluates traffic next. Matching traffic is
allowed to pass to its destination without further inspection,
though it is still subject to identity requirements and rate
limiting. Traffic that does not match continues to the next rule.</p></li><li><p><strong>Rule 3: Block</strong> evaluates traffic third. Matching traffic is
blocked without further inspection. Traffic that does not match
continues to the final rule. (Optional) Interactive Block allows a
user to bypass the block if deemed appropriate. Typically a
user-defined warning message is displayed alongside an interactive
block explaining the company security policy.</p></li><li><p><strong>Rule 4: Allow</strong> is the final rule. For this rule matching traffic
is allowed. However, prohibited files, malware, intrusions, and
exploits within that traffic are detected and blocked. Remaining
non-prohibited, non-malicious traffic is allowed to its destination,
though it is still subject to identity requirements and rate
limiting. You can configure Allow rules that perform only file
inspection, or only intrusion inspection, or no further inspection.</p></li><li><p><strong>Default Action</strong> handles all traffic that does not match any of
the rules in the ACP. In this scenario, the default action performs
a Block All, which is considered best practice in most deployments,
as any traffic that hasn&#x27;t explicitly been allowed or denied per
your organization&#x27;s strategic security policy should be blocked and
logged for further analysis.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="acp-default-action"></a>ACP Default Action<a class="hash-link" href="#acp-default-action" title="Direct link to heading">#</a></h3><p>As seen above, each ACP has a default action. A newly created policy
(without any custom rules) will direct managed devices targeted by that
policy to handle all traffic using the <strong><em>default action</em></strong>. When rules
are added to the policy by the firewall administrator, the default
action applies to the traffic that:</p><ul><li><p>is not on a Security Intelligence block list</p></li><li><p>is not blocked by SSL inspection</p></li><li><p>does not match any of the rules in the policy defined by the
administrator</p></li></ul><p>The default action can be set to block traffic, trust traffic without
further inspection or analyze traffic for intrusion and discovery data.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="access-rule-order"></a>Access Rule Order<a class="hash-link" href="#access-rule-order" title="Direct link to heading">#</a></h3><p>Where you place rules in your ACP is important. A specific rule to
<strong><em>block</em></strong> traffic can be missed if a more general rule <strong><em>allows</em></strong>
traffic above it in the policy. Whereas a rule that <strong><em>allows</em></strong> traffic
may never trigger if there is a <strong><em>block</em></strong> rule matching traffic before
it.</p><p>Another effect on rule ordering is performance. Rules that require
further inspection (such as Intrusion Prevention or File and Malware
processing) consume more resources. Therefore, it is advisable to remove
as many threats as possible using less resource intensive methods such
as blocking traffic using layer-3/4 criteria (such as IP address,
security zone and port number).</p><p>In general, place rules that are likely to be &quot;<strong><em>hit</em></strong>&quot; the most
towards the top of your policy, along with more specific rules. Whenever
possible, place specific block rules near the top of the policy so that
the firewall can make the earliest possible decision on undesirable
traffic, especially if those rules block traffic based on layer-3/4
criteria. Rules that filter on URL or application should come next,
followed by the more resource intensive rules that require the traffic
to be processed further by Intrusion and/or file policies.</p><p>There are no hard and fast rules on how you structure your ACP. However,
the guidelines above will help to ensure that you achieve the best
performance out of your firewall. The most crucial factor is that you
have the correct rules to suit your organization&#x27;s security needs.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prefilter-policies-and-security-intelligence"></a>Prefilter Policies and Security Intelligence<a class="hash-link" href="#prefilter-policies-and-security-intelligence" title="Direct link to heading">#</a></h3><p>Before processing network traffic by the Access Control policy, there
are additional security checks and controls that can be used to further
enhance your security posture. These componenets bring advantages both
in terms of performance fine tuning and security effectiveness.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prefilter-policies"></a>Prefilter Policies<a class="hash-link" href="#prefilter-policies" title="Direct link to heading">#</a></h4><p>Prefiltering can be thought of as the first phase of access control
before the firewall passes connections onto more resource intensive
evaluation controls. A prefilter policy uses limited, outer-header
criteria to process connections quickly. The rule actions available in a
prefilter policy are <strong><em>Fastpath, Block and Analyze</em></strong>.</p><p>The <strong>Fastpath</strong> rule action in the prefilter policy bypasses all
further packet inspection and handling, including security intelligence,
authentication requirements, SSL decryption, access control rules, deep
inspection (NGIPS), network discovery and rate limiting.</p><p>Fastpathing traffic is useful where connections are trusted, therefore
not requiring further controls or inspection. The real benefit of the
fastpath action is improved performance.</p><p>The <strong>Block</strong> rule action in the prefilter policy allows the system to
block connections at the earliest possible stage as they traverse the
firewall. Useful for identifiable connections that can be blocked using
basic layer-3/4 criteria, discarding them without requiring too much
processing overhead.</p><p>The <strong>Analyze</strong> rule action in the prefilter policy is for all other
connections that are not being blocked or fastpathed. The Analyze rule
action tells the policy to pass the connections to the next control
point in the packet flow process, including sending the connections to
the Security Intelligence checks, access control policy and potentially
more advanced controls such as NGIPS and Malware control.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="security-intelligence"></a>Security Intelligence<a class="hash-link" href="#security-intelligence" title="Direct link to heading">#</a></h4><p>Security Intelligence (SI) is another early defense against malicious
activity applied before passing connections to the access control policy
for further processing. SI uses reputation based intelligence backed by
Talos, the threat intelligence organization at Cisco. It can block
connections to or from IP addresses, URLs and domain names using a
block-list, improving performance by quickly excluding traffic from
further inspection.</p><p>A <strong><em>Threat</em></strong> license is required to use SI, which enables the regular
update of intelligence feeds. Intelligence feeds are provided by Cisco,
and the option of using supplemental third-party and custom feeds
without a license. In addition to custom blocklists, creating custom
allow lists allow for overriding SI blocking if required.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configuration"></a>Configuration<a class="hash-link" href="#configuration" title="Direct link to heading">#</a></h2><p>The following steps guide you by creating a basic Access Control Policy
and adding rules to control traffic to traverse a managed firewall.</p><p><strong>Best Practice:</strong> With any firewall policy configuration, it is
recommended to be as specific as possible. That is to say, have a full
understanding of your companies strategic security policy and the
requirements of your users and business operations. This approach will
allow you to create an access control policy that blocks unwanted
traffic, allows everyday business transactions and provides auditing
that can help in the event of a breach.</p><p>This example assumes that the firewall is an Internet-facing, edge
firewall protecting a trusted, internal network and a semi-trusted DMZ.
These scenarios typically have the following requirements:</p><ul><li><p>Only allow limited inbound traffic from the outside (Internet) to
the inside or DMZ networks</p></li><li><p>Provide access to the Internet for web browsing from internal
systems and users in a controlled manner</p></li><li><p>Provide backend access between the internal networks and the DMZ</p></li><li><p>Ensure logging and auditing of connections to assist in
troubleshooting</p></li></ul><p><strong>Step 1:</strong> Create a new Access Control Policy by navigating to
<strong>Policies &gt; Access Control</strong></p><p><strong>Step 2:</strong> Click <strong>New Policy</strong></p><p><img src="/securefirewallessentials/assets/images/image2-a91eab7d26320782d2140dcc9c2c552a.png"></p><p>Enter a name for the policy along with an optional description.</p><p>Choose <strong>Block all traffic</strong> for the <strong>Default Action</strong> to ensure that
any traffic that isn&#x27;t matched by rules will be blocked.</p><p>Under <strong>Targeted Devices</strong>, select the firewall or firewalls that this
policy will be applied to and click <strong>Add to Policy</strong>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can create a policy without specifying target devices,
which is useful if you are designing your policy and do not want to
apply it until you are ready.</p></div></div><p>Clicking <strong>Save</strong> presents you with an empty policy (Figure 3):</p><p><img alt="Empty AC Policy" src="/securefirewallessentials/assets/images/image3-80a80856dea84b9fba2637b6b6db3b98.png"></p><p><strong>Figure 3:</strong> New Access Control Policy (empty)</p><p><strong>Step 3:</strong> At this stage, if you deployed this policy to a managed
firewall, it would block all traffic using the Default Action. To begin
adding rules, click on the <strong>Add Rule</strong> button towards the top-right of
the window.</p><p><strong>Step 4:</strong> First, we will add rules that allow mail and web access to
servers on the semi-trusted DMZ from the Internet. Before creating the
rules, it&#x27;s best to create the network objects we&#x27;re going to use first
to reference them in the rules later.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Objects can be created in the Object Management window or
directly from within the Add Rule properties. We&#x27;ll show both so you can
decide which method works best for you.</p></div></div><p>  <strong>Step 4a:</strong> Navigate to <strong>Objects &gt; Object Management</strong> and click
<strong>Network</strong> in on the left-hand side.</p><p>  <strong>Step 4b:</strong> At the top of the window, click on the <strong>Add Network</strong>
drop-down list and click <strong>Add Object</strong>.</p><p>  <strong>Step 4c:</strong> Complete the fields as shown in <em>Figure 4</em> below,
substituting the IP address for your own:</p><p>  <img src="/securefirewallessentials/assets/images/image4-7b83b6447ef69a3fa4976f22b3ab0860.png"></p><p>  <strong>Figure 4:</strong> New Network Object</p><p>  <strong>Step 4d</strong>: Click <strong>Save</strong></p><p><strong>Step 5:</strong> Next, add a rule to the Access Policy created in Step 2 to
allow web traffic to the server on the DMZ.</p><p>  <strong>Step 5a:</strong> Navigate to <strong>Policies &gt; Access Control</strong> and click on the
pencil icon to edit the access control policy.</p><p><img alt="Edit AC Policy" src="/securefirewallessentials/assets/images/image3-80a80856dea84b9fba2637b6b6db3b98.png"></p><p><strong>Figure 5:</strong> Edit Access Control Policy</p><p><strong>Step 5b:</strong> Click <strong>+Add Rule</strong> (over on the top-right hand side)</p><p><strong>Step 5c:</strong> General rule properties.</p><ul><li><p>Assign a rule <strong>Name</strong> that helps identify the purpose of the rule
without viewing each component in detail.</p></li><li><p>The <strong>Enabled</strong> checkbox allows the rule to be enabled/disabled</p></li><li><p>The <strong>Action</strong> defines how we want the firewall to handle the
traffic that matches the rule. In this example, we want to allow the
traffic to our web server.</p></li><li><p><strong>Insert</strong> lets you choose where rule to appears in the policy. The
position can be changed at any time.</p></li><li><p>The <strong>Time Range</strong> allows you to control when the rule should be
active, including setting recurring schedules. This rule is always
active, so we&#x27;ll leave this set to <strong>None.</strong></p></li></ul><p><img alt="Rule Properties" src="/securefirewallessentials/assets/images/image5-28e98cd06fce0010293525112eb56ff2.png"></p><p><strong>Figure 6:</strong> General Rule Properties</p><p><strong>Step 5d:</strong> Now configure the rule matching criteria. The first tab
adds <strong>Zones</strong>, which in this example from the list of zones available,
we&#x27;ve added <strong><em>DMZ</em></strong> to <strong>Destination</strong> and <strong><em>Outside</em></strong> to
<strong>Source</strong>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Create Zones under <strong>Objects &gt; Object Management &gt;
Interfaces</strong> or during device configuration and are used to represent
security zones made up of one or more interfaces.</p></div></div><p><img alt="Adding Zones" src="/securefirewallessentials/assets/images/image6-097c8af90f443af2d51812dad9fa23d6.png"></p><p><strong>Figure 7:</strong> Adding Zones to the access rule</p><p><strong>Step 5e:</strong> Next, we move to the <strong>Networks</strong> tab. Here we can control
which source/destination networks/hosts we want to communicate. Figure 8
shows the completed Networks tab.</p><ul><li><p>In our example, we&#x27;re hosting a public webserver with a source
network of <strong>ANY,</strong> which is the default for both source and
destination.</p></li><li><p>For the destination, look in the list of available networks, select
<strong>Webserver_Public</strong> and click <strong>Add to Destination</strong>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If the network object doesn&#x27;t exist, you can create one &quot;on
the fly.&quot; To the right of the &quot;<strong>Available Networks</strong>&quot; click the <strong>+</strong>
sign to create a new network object, as seen in <strong>Step 4c</strong>.</p></div></div></li></ul><p><img alt="Network Objects" src="/securefirewallessentials/assets/images/image7-e7651e38b462122f711b8640111d5103.png"></p><p><strong>Figure 8:</strong> Configuring Network object controls</p><p><strong>Step 5f:</strong> The <strong>Applications</strong> allow the firewall to inspect the
traffic to ensure that the correct applications access resources. Again,
in our example, we are hosting a public webserver, so the applications
we want to allow are HTTP and HTTPS.</p><ul><li><p>From the list of <strong>Available Applications</strong>, type <strong>HTTP</strong> in the
search box. Then select <strong>HTTP</strong>, <strong>HTTPS</strong> and click <strong>Add to
Rule.</strong></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Application Visibility and Control (AVC) causes the firewall
to inspect the payload of network connections, verifying that the
connections contain the allowed application to prevent malicious
actors from tunneling different applications across standard ports.
Traditional port-based rules would miss this activity. Combining
<strong>applications</strong> and <strong>ports</strong> to force applications to use a
particular port number provides better access control. For example,
configuring HTTP as the destination application and 80/tcp as the
destination port ensures that all HTTP connections occur over port
80/tcp. With no port specified, then HTTP as an application would be
accepted over any tcp port.</p></div></div></li></ul><p><img alt="Add Apps" src="/securefirewallessentials/assets/images/image8-9cf2b831bad61021e091644b1e273606.png"></p><p><strong>Figure 9:</strong> Adding applications to our matching criteria</p><p><strong>Step 5g:</strong> The final step in our example rule is to define the Logging
options. Move to the Logging tab and check the following boxes:</p><ul><li><p><strong>Log at Beginning of Connection</strong></p><p><em>Creates a log event when connections are established.</em></p></li><li><p><strong>Log at End of Connection</strong></p><p><em>Creates a log event when connections are closed.</em></p></li><li><p><strong>Send Connection Events to Event Viewer</strong></p><p><em>Sends events to the internal event viewer for review.</em></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Best practice for logging depends on your security strategy
and regulatory compliance requirements. In general, only log at both
the beginning and end of connections if you want to capture audit
information such as duration of connection and the number of bytes
sent/received.</p></div></div></li><li><p>Click <strong>Add</strong></p></li></ul><p><img alt="Logging Options" src="/securefirewallessentials/assets/images/image9-1ec98ed1dc455ffe29b304e1ffaa054c.png"></p><p><strong>Figure 10:</strong> Logging options</p><p><strong>Step 6:</strong> Now that the rule is configured, create a <strong>Network Address
Translation (NAT)</strong> rule so the firewall can forward packets that arrive
destined for the webserver&#x27;s public IP address to it&#x27;s private
(internal) address on the DMZ.</p><p><strong>Step 6a:</strong> <strong>Navigate to Devices &gt; NAT</strong>. Click <strong>New Policy</strong> and
select <strong>Threat Defense NAT</strong>.</p><p><strong>Step 6b:</strong> Give the Policy a <strong>name</strong> and add your firewall device to
the policy by clicking the device name under <strong>Available Devices</strong> and
then clicking <strong>Add to Policy</strong>.</p><p><strong>Step 6c:</strong> Click <strong>+ Add Rule</strong>. We&#x27;re going to use an <strong>Auto NAT
Rule</strong> in our example to translate connections arriving at the firewall
for the webserver. Auto NAT is the simplest form of NAT where the NAT
rule becomes a parameter for a network object. The network object IP
address serves as the original (real) address. Complete the rule using
the detail below and <em>figure 11</em> as reference.</p><ul><li><p>Under <strong>NAT Rule</strong>, select <strong>Auto NAT Rule</strong>.</p></li><li><p>For <strong>Type</strong>, select <strong>Static</strong></p></li><li><p>On the <strong>Interface Objects tab</strong>, select <strong>DMZ</strong> for the <strong>Source
Interface Objects</strong> and <strong>Outside</strong> for the <strong>Destination Interface
Objects</strong>.</p></li><li><p>On the <strong>Translation tab</strong>, select <strong>Webserver_Private</strong> as the
<strong>Original Source</strong> and for <strong>Translated Source</strong>, select
<strong>Address &gt; Webserver_Public</strong></p></li><li><p>Click <strong>Ok</strong> and <strong>save</strong> the NAT policy.</p></li></ul><p><img alt="NAT" src="/securefirewallessentials/assets/images/image10-25d45bdf57bcb7b3e582be46debb70ee.png"></p><p><strong>Figure 11:</strong> Auto NAT Rule</p><p><strong>Step 7:</strong> Repeat Steps 4 to 6 to complete objects, rules and NAT for
inbound SMTP (mail) access. Create objects that reference the relevant
IP addresses for the public and private address for your mail server.</p><p><strong>Step 8:</strong> Next, create a rule to allow general Internet access from
the inside network. If not already open, Navigate to Policies &gt; Access
Control and edit your access control policy by clicking the pencil icon.</p><p><strong>Step 8a:</strong> Click <strong>+Add Rule</strong> and configure the general rule options
as below in <em>Figure 12</em>:</p><p><img alt="Auto NAT" src="/securefirewallessentials/assets/images/image11-c58d49189dbebdd568ef1695c869a019.png"></p><p><strong>Figure 12:</strong> Outbound Internet rule general options</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>We&#x27;re inserting the rule below rule number 2 (our Inbound Web
Access rule) as this follows our best practice of placing more specific
rules above more general rules.</p></div></div><p><strong>Step 8b:</strong> As done in the Inbound Web Access rule, add the matching
criteria for the rule, including zones, applications and logging
options. Use the following example settings:</p><ul><li><p><strong>Zones tab:</strong> Source Zone = <strong>Inside</strong>, Destination Zone =
<strong>Outside</strong> <em>Figure 13</em></p></li><li><p><strong>Applications tab:</strong> Add <strong>DNS</strong>, <strong>HTTP</strong>, <strong>HTTPS</strong> and <strong>FTP</strong>
to the <strong>Selected Applications and Filters</strong> box <em>Figure 14</em></p></li><li><p><strong>Logging tab:</strong> Check both <strong>Log at Beginning</strong> &amp; <strong>End of
Connection</strong> and Send Connection Events to <strong>Event Viewer</strong>
<em>Figure 15</em></p></li></ul><p><img alt="Outbound Rule" src="/securefirewallessentials/assets/images/image12-38306411f049075e0e6cd5beecb51006.png"></p><p><strong>Figure 13:</strong> Configure Zones</p><p><img alt="Zones" src="/securefirewallessentials/assets/images/image13-a69675741809aae8038bbc3eb4bc8e56.png"></p><p><strong>Figure 14:</strong> Add Applications to the rule</p><p><img alt="Applications" src="/securefirewallessentials/assets/images/image14-b9e8c44142f3a73fdc72bb87bd67c9a9.png"></p><p><strong>Figure 15:</strong> Configure Logging Options</p><p><strong>Step 8c:</strong> Click <strong>Add</strong> and then click <strong>Save</strong> to commit your
changes to the policy.</p><p><img alt="Logging Options" src="/securefirewallessentials/assets/images/image15-546df70835da976a7041895852e80ebe.png"></p><p><strong>Figure 16:</strong> Access Control Policy so far</p><p><strong>Step 8d:</strong> To accompany the Outbound Internet rule, we need a NAT rule
for connections that originate from our internal (private) network,
going to the Internet with a valid, publicly routable IP address.
Navigate to <strong>Devices &gt; NAT</strong> and edit your NAT policy by clicking the
<strong>pencil</strong> icon.</p><p><strong>Step 8e:</strong> Click <strong>+Add Rule</strong>. This time we&#x27;re going to use a
<strong>Dynamic</strong> <strong>Auto NAT Rule</strong> to translate connections leaving the
firewall from inside to outside by translating them using a range of
public IP addresses. Complete the rule using the detail below and
<em>Figure 17</em> as reference.</p><ul><li><p>Under <strong>NAT Rule</strong>, select <strong>Auto NAT Rule</strong>.</p></li><li><p>For <strong>Type</strong>, select <strong>Dynamic</strong></p></li><li><p>On the <strong>Interface Objects tab</strong>, select <strong>Inside</strong> for the <strong>Source
Interface Objects</strong> and <strong>Outside</strong> for the <strong>Destination Interface
Objects</strong>.</p></li><li><p>On the <strong>Translation tab</strong>, select <strong>your internal subnet</strong> as the
<strong>Original Source</strong> and for <strong>Translated Source</strong>, select
<strong>Address</strong> and then click the + sign to add a new network object.</p></li><li><p>Give the new object a name (e.g. <strong>Example_NAT_Pool</strong>), select
Range, and enter a valid public IP address range from your available
public address space. Enter the range in the form of
<em>x.x.x.x-x.x.x.x</em> (see Figure 18 as an example).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A more straightforward way of achieving this is to have all
outbound traffic use the outside interface&#x27;s IP address as a
translated source address to negate the need to create a NAT
pool/range object. This configuration is useful for smaller or remote
office deployments where the number of concurrent outbound connections
is relatively low.</p></div></div></li><li><p>Click <strong>Save</strong> to save the new network object and select it from the
drop-down list under <strong>Translated Source</strong>.</p></li><li><p>Click <strong>Ok</strong> and <strong>save</strong> the NAT policy.</p></li></ul><p><img alt="NAT Rule" src="/securefirewallessentials/assets/images/image16-87d985a7ce1442686cffcdc931834d92.png"></p><p><strong>Figure 17:</strong> Dynamic Auto NAT rule</p><p><img alt="DNAT Rule" src="/securefirewallessentials/assets/images/image17-c7e14f172d26f0442016374185af14c0.png"></p><p><strong>Figure 18:</strong> NAT Pool object example</p><p><strong>Step 8f:</strong> Apply URL control to access control rules (optional). If
you have a <strong>URL</strong> license for your deployment, it is possible to
control the categories of websites that your users can access. URL
control uses the Talos web category database that provides control of
85+ content and threat categories.</p><p><strong>Step 8g:</strong> Navigate to <strong>Policies &gt; Access Control</strong> and edit your
access control policy by clicking the pencil icon. Edit the rule created
above in <strong>Step 8a</strong> Outbound Internet).</p><p><strong>Step 8h:</strong> Move to the <strong>URLs</strong> tab for the rule and add the
categories you want to allow (or deny if the rule is a block rule) to
the <strong>Selected URLs</strong> box.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You can control access based on ANY URL within a category or
URLs with a specific reputation score.</p></div></div><p><img alt="URLs" src="/securefirewallessentials/assets/images/image18-794653627915917f5f54c76f51a2c34b.png"></p><p><strong>Figure 19:</strong> (Optional) URL Category Control</p><p><strong>Step 9:</strong> The final rule in our example is to allow connections
between the inside network and the DMZ for backend communications
between the web server and internal databases or for other required
application traffic. This rule does not require NAT, as the DMZ networks
and inside are private, so we control the routing. However, to add
additional security, we will see how to attach <strong>Intrusion Prevention</strong>,
<strong>File</strong> and <strong>Malware</strong> control to the access policy rules.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>A valid THREAT license (subscription) is required to use NGIPS
policies, and a valid Malware license (subscription) is required to
enable Malware &amp; File control.</p></div></div><p><strong>Step 9a:</strong> Before we add a rule to our access control policy, we need
to create a File &amp; Malware policy to attach to our new rule. Navigate to
<strong>Policies &gt; Malware &amp; File</strong> and click <strong>New File Policy</strong>. Give the
file policy a name, e.g. Block Malware &amp; Executables</p><p><img alt="New File Policy" src="/securefirewallessentials/assets/images/image19-bd086086c3f22ff112478c615561d539.png"></p><p><strong>Figure 20:</strong> New File Policy</p><p><strong>Step 9b:</strong> Click +Add Rule and configure as per Figure 21 below to
block executable files and click <strong>Save</strong>.</p><p><img alt="File Policy" src="/securefirewallessentials/assets/images/image20-01b25f621a0597091051bbbc64220559.png"></p><p><strong>Figure 21:</strong> Block executable files</p><p><strong>Step 9c:</strong> Click <strong>+Add Rule</strong> again and configure as per Figure 22
below to block traffic identified as containing malware.</p><p><img alt="Add Rule" src="/securefirewallessentials/assets/images/image21-3b1d82111e49900349bb30966b1e60eb.png"></p><p><strong>Figure 22:</strong> Block Malware rule</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Under File Type Categories, select all except for Executables
(we&#x27;re blocking these in the previous rule), Dynamic Analysis Capable
and Local Malware Analysis Capable.</p></div></div><p><strong>Step 9d:</strong> Click <strong>Save</strong> to save the rule and then <strong>Save</strong> again to
commit the changes to our Malware &amp; file Policy.</p><p><strong>Step 9e:</strong> Navigate to <strong>Policies &gt; Access Control</strong> and edit your
access control policy by clicking the <strong>pencil</strong> icon. Click <strong>+Add
Rule</strong> and complete the general rule options as shown here in Figure 23.</p><p><img alt="Edit AC Policy" src="/securefirewallessentials/assets/images/image22-e1f190f748095c7fcdad2402000e310a.png"></p><p><strong>Figure 23:</strong> General Rule Policy</p><p><strong>Step 9f:</strong> Next, add a rule to allow <strong>ANY</strong> connections between the
<strong>Inside</strong> and <strong>DMZ</strong> zones.</p><p><strong>Note: After adding the zones, all other tabs can be left as default
(any).</strong></p><p><img alt="AC Rule" src="/securefirewallessentials/assets/images/image23-4f2e35d0ba07a35cbb2c2bb514b09d15.png"></p><p><strong>Figure 24:</strong> Zone configuration</p><p><strong>Step 9g:</strong> To add Next Generation Intrusion Prevention (NGIPS) to
traffic that matches this rule, move to the <strong>Inspection</strong> tab and
select the <strong>Balanced Security and Connectivity</strong> Intrusion Policy.
Using this base policy adds a default SNORT policy to the rule to
identify threats and vulnerabilities that may be present in the traffic.
NGIPS is backed by Cisco&#x27;s Talos organization,, which is comprised world
class threat hunters and security intelligence gathered worldwide.</p><p><img alt="Zones" src="/securefirewallessentials/assets/images/image24-8a6e6cc11b5e131f2dd323b6605695da.png"></p><p><em>F</em>igure 25:** Next Generation Intrusion Policy selection</p><p><strong>Step 9h:</strong> For <strong>File Policy</strong>, select the Malware &amp; File Policy we
created in <strong>Step 9a</strong>.</p><p><img alt="File Policy" src="/securefirewallessentials/assets/images/image25-06cd8f2af56f8d7b770bdab2cb67be99.png"></p><p><strong>Figure 26:</strong> Malware &amp; File Policy selection</p><p><strong>Step 9i:</strong> Click <strong>Save</strong> to save the rule. Your Access Control Policy
should look similar to Figure 26:</p><p><img alt="Save AC Policy" src="/securefirewallessentials/assets/images/image26-372894e7fe7582a8d22398a4c3d485f6.png"></p><p><em>Figure 27 Completed Access Control Policy</em></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For the last rule, notice that the Intrusion Policy and Malware
&amp; File Policy icons are active. The icons indicate that the rule has
advanced inspection options enabled. Hovering your mouse over the icons
shows which is which.</p><p><img alt="Completed AC Policy" src="data:image/png;base64,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"></p></div></div><p><strong>Step 9j:</strong> Click <strong>Save</strong> to save the changes to the access control
policy.</p><p>Step 10: The access control policy is now ready to deploy to your
device. Navigate to <strong>Deploy &gt; Deployment</strong>. Check the device and then
click the <strong>Deploy</strong> button.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="verificationtroubleshooting"></a>Verification/Troubleshooting<a class="hash-link" href="#verificationtroubleshooting" title="Direct link to heading">#</a></h2><p>To verify your configuration, check that you can access devices/networks
as per your access rules. For example, check that a device (e.g. a web
browser) can access your webserver from the Internet. Also, check that
users on the internal network can access the Internet.</p><p>If connectivity isn&#x27;t as expected, check the event logs for details.
Remember, we enabled logging on all rules to get this valuable
information.</p><p>Navigate to <strong>Analysis &gt; Connections &gt; Events</strong> and verify that you
can see connection events related to your activity. Then confirm that
the <strong>action</strong> for that event is what you expect (e.g. allowed/blocked).
If not, verify your access control policy rules have the correct action
defined. It&#x27;s a common mistake to create a rule and forget to change the
action to the desired option.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>Access Control policies are a crucial component of your Firepower NGFW
deployment. They allow you to map your organization&#x27;s security strategy
and policies to the network connections that traverse your firewall or
firewalls. Granular and flexible, they allow configuration that protects
and controls up to the application layer. When combined with NGIPS and
Malware policies, the firewall becomes a powerful, multifaceted threat
defense solution.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://securefirewallessentials.github.io/docs/FMC_AccessControlP.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/securefirewallessentials/docs/ssl-policy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« SSL Policy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/securefirewallessentials/docs/snmp"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SNMP Monitoring Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#background-information" class="table-of-contents__link">Background Information</a></li><li><a href="#access-control" class="table-of-contents__link">Access Control</a><ul><li><a href="#access-control-policy-processing" class="table-of-contents__link">Access Control Policy Processing</a></li><li><a href="#acp-default-action" class="table-of-contents__link">ACP Default Action</a></li><li><a href="#access-rule-order" class="table-of-contents__link">Access Rule Order</a></li><li><a href="#prefilter-policies-and-security-intelligence" class="table-of-contents__link">Prefilter Policies and Security Intelligence</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link">Configuration</a></li><li><a href="#verificationtroubleshooting" class="table-of-contents__link">Verification/Troubleshooting</a></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/securefirewallessentials/docs/">FMC Best Practices</a></li><li class="footer__item"><a class="footer__link-item" href="/securefirewallessentials/docs/SNMP/">SNMP Monitoring</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://cs.co/netsec-community" target="_blank" rel="noopener noreferrer" class="footer__link-item">NetSec Community</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC7rdKaO-3UPPXmkJkI6wgcg?view_as=subscriber" target="_blank" rel="noopener noreferrer" class="footer__link-item">NetSec YouTube Channel</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/securefirewallessentials/blog">Blog</a></li><li class="footer__item"><a href="https://securefirewallessentials.github.io/securefirewallessentials/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Secure Firewall Essentials</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Â© 2021 Cisco Systems, Inc.</div></div></div></footer></div>
<script src="/securefirewallessentials/styles.a4842356.js"></script>
<script src="/securefirewallessentials/runtime~main.f1b07267.js"></script>
<script src="/securefirewallessentials/main.198f0307.js"></script>
<script src="/securefirewallessentials/1.daadf3d3.js"></script>
<script src="/securefirewallessentials/30.7c88bcd9.js"></script>
<script src="/securefirewallessentials/31.d754188b.js"></script>
<script src="/securefirewallessentials/935f2afb.5904cdef.js"></script>
<script src="/securefirewallessentials/29.57805d62.js"></script>
<script src="/securefirewallessentials/7d74e1b1.e5dc3d2b.js"></script>
</body>
</html>