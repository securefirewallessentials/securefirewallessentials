(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var r=n(0),o=n.n(r);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=o.a.createContext({}),p=function(e){var t=o.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},b=function(e){var t=p(e.components);return o.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(n),u=r,m=b["".concat(i,".").concat(u)]||b[u]||d[u]||a;return n?o.a.createElement(m,c(c({ref:t},l),{},{components:n})):o.a.createElement(m,c({ref:t},l))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:r,i[1]=c;for(var l=2;l<a;l++)i[l]=n[l];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},290:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image2-0844f64bae1cab8e3efd026bf20f61f5.png"},291:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image3-9e8260d819418644065f1d87168a556b.png"},292:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image4-7e27b2e79abacea191b78403bec8440a.png"},293:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image5-0452c6fc310872efda9cc193d214990f.png"},294:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image6-2daaa0cc96b613e9d7f5eab8393dcd63.png"},295:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image7-4a1da3055a81089403f23eda17439236.png"},296:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image8-49d70df968c5e70c6d651fd415d8af03.png"},297:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image9-e4b843bf759aeffed0a6135d1f68145e.png"},94:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return b}));var r=n(3),o=n(7),a=(n(0),n(101)),i=["components"],c={id:"discovery-policy",title:"Discovery Policy",description:"Configuring the Dicsovery Policy on the FMC",hide_table_of_contents:!1},s={unversionedId:"discovery-policy",id:"discovery-policy",isDocsHomePage:!1,title:"Discovery Policy",description:"Configuring the Dicsovery Policy on the FMC",source:"@site/docs/FMC_DiscoveryP.md",slug:"/discovery-policy",permalink:"/securefirewallessentials/docs/discovery-policy",editUrl:"https://securefirewallessentials.github.io/docs/FMC_DiscoveryP.md",version:"current",sidebar:"firstSidebar",previous:{title:"Smart Licensing",permalink:"/securefirewallessentials/docs/"},next:{title:"File and Malware Policy",permalink:"/securefirewallessentials/docs/file-policy"}},l=[{value:"Introduction",id:"introduction",children:[]},{value:"Network Discovery Policy",id:"network-discovery-policy",children:[]},{value:"Network Discovery Configuration",id:"network-discovery-configuration",children:[]},{value:"Firepower Recommendations",id:"firepower-recommendations",children:[]},{value:"Verification/Troubleshooting",id:"verificationtroubleshooting",children:[]},{value:"Summary",id:"summary",children:[]},{value:"Additional Resources",id:"additional-resources",children:[]}],p={toc:l};function b(e){var t=e.components,c=Object(o.a)(e,i);return Object(a.b)("wrapper",Object(r.a)({},p,c,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"May 22, 2021"),Object(a.b)("h2",{id:"introduction"},"Introduction"),Object(a.b)("p",null,"This document provides Cisco's best practice steps for configuring and\ndeploying the network discovery policy. The network discovery policy on\nthe Cisco Firepower Management Center (FMC) controls how the system\ncollects asset data on an organization's network and which network\nsegments and ports to monitor."),Object(a.b)("h2",{id:"network-discovery-policy"},"Network Discovery Policy"),Object(a.b)("p",null,"A discovery policy specifies the networks and ports that a Firepower\nsystem passively monitors to generate discovery data based on the\nnetwork traffic passing through the deployed firewalls. A discovery rule\ndefines the hosts, applications, and non-authoritative users to monitor.\nSimilarly, a discovery rule can be created to exclude networks and zones\nfrom discovery."),Object(a.b)("h2",{id:"network-discovery-configuration"},"Network Discovery Configuration"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Policies")," ",">"," ",Object(a.b)("strong",{parentName:"p"},"Network Discovery"),"."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Discovery Policy",src:n(290).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 1:")," Network Discovery Option from the Policies Menu"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": Remove the default discovery rule (that includes 0.0.0.0/0\nand ::/0 subnets) by clicking on the trash can on the right."),Object(a.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(a.b)("div",{parentName:"div",className:"admonition-heading"},Object(a.b)("h5",{parentName:"div"},Object(a.b)("span",{parentName:"h5",className:"admonition-icon"},Object(a.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(a.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(a.b)("div",{parentName:"div",className:"admonition-content"},Object(a.b)("p",{parentName:"div"},"This rule allows an FMC to discover applications from all observed traffic and\npossibly cause the FMC to reach its maximum limit for discovering hosts\nand users quickly."))),Object(a.b)("p",null,Object(a.b)("img",{alt:"Remove Defaults",src:n(291).default}),"\n",Object(a.b)("strong",{parentName:"p"},"Figure 2:")," Default Discovery Rule"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 3"),": Click ",Object(a.b)("strong",{parentName:"p"},"Add Rule")," on the right side to add a discovery\nrule. The ",Object(a.b)("strong",{parentName:"p"},"Add Rule")," window displays."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 4"),": Choose the predefined network objects or create new network\nobjects that define your company's internal network precisely. (The\nscreenshot below shows the available RFC-1918 IP addresses.) In a\nreal-world deployment, this object should include only the internal\nnetworks that require profiling. The system ",Object(a.b)("strong",{parentName:"p"},"IPv4-Private-All-RFC1918"),"\nnetwork object may be suitable initially if the networks in use are\nunknown or for the discovery of rogue networks."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Add Private",src:n(292).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 3:")," Creation of a Discovery Rule"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 5"),": Choose an action from the drop-down menu at the top and then\ncheck one of the checkboxes. The following table describes possible\nactions, options, and functions."),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",{parentName:"tr",align:null},"Action"),Object(a.b)("th",{parentName:"tr",align:null},"Option"),Object(a.b)("th",{parentName:"tr",align:null},"Function"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("strong",{parentName:"td"},"Discover")),Object(a.b)("td",{parentName:"tr",align:null},"Hosts"),Object(a.b)("td",{parentName:"tr",align:null},"Adds hosts to the network map based on discovery events. (Optional, unless user discovery is enabled, then required.)")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("strong",{parentName:"td"},"Discover")),Object(a.b)("td",{parentName:"tr",align:null},"Applications"),Object(a.b)("td",{parentName:"tr",align:null},"Adds applications to the network map based on application detectors. Note that the Firepower system cannot discover hosts or users in a rule without also discovering applications. (Required)")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("strong",{parentName:"td"},"Discover")),Object(a.b)("td",{parentName:"tr",align:null},"Users"),Object(a.b)("td",{parentName:"tr",align:null},"Adds users to the user's table and logs user activity based on traffic-based detection on the user protocols configured in the network discovery policy. (Optional)")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("strong",{parentName:"td"},"Exclude")),Object(a.b)("td",{parentName:"tr",align:null},"N/A"),Object(a.b)("td",{parentName:"tr",align:null},"Excludes the specified network from monitoring. If the source or destination host for a connection is excluded from discovery, the connection is recorded, but discovery events are not created for excluded hosts.")))),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 6"),": Possible hosts to consider for exclusion from monitoring\ninclude load balancers (or specific ports on load balancers) and NAT\ndevices. These devices may create excessive and misleading events, which\nfill the FMC database. For example, a monitored NAT device might exhibit\nmultiple updates of its operating system in a short period. However,\nexcluding the NAT device from monitoring, the excessive and duplicate\ndiscovery events do not appear in the network map and no events are\nreported."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 7"),": Once the rule conditions are defined, click ",Object(a.b)("strong",{parentName:"p"},"Save")," to save\nthe discovery rule. The ",Object(a.b)("strong",{parentName:"p"},"Discovery Policy")," window redisplays."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Discovery Rule",src:n(293).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 4:")," An Example of Discovery Rules with Discover and Exclude Actions"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 8"),": From the ",Object(a.b)("strong",{parentName:"p"},"Advanced")," tab, click the pencil icon to edit the\n",Object(a.b)("strong",{parentName:"p"},"General Settings"),". A pop-up window displays."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Discovery Advanced",src:n(294).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 5:")," Enabling the Capturing of Banners in the Advanced Settings"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 9"),": Check the ",Object(a.b)("strong",{parentName:"p"},"Capture Banner")," checkbox to store header\ninformation from network traffic that advertises server vendors and\nversions. This banner information can provide additional context to the\ninformation gathered during discovery."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 10"),": Deploy the discovery policy. Choose ",Object(a.b)("strong",{parentName:"p"},"Deploy ",">","\nDeployment"),", choose the desired FTD device, and then click ",Object(a.b)("strong",{parentName:"p"},"Deploy"),"."),Object(a.b)("h2",{id:"firepower-recommendations"},"Firepower Recommendations"),Object(a.b)("p",null,"The FMC starts building a network map as soon as a discovery policy is\ndeployed and traffic is seen on managed devices with a discovery policy\napplied. After running a discovery policy for several days, the FMC\ncreates a network map and host profiles with details about the operating\nsystems, servers, and client applications running in an environment. The\nFirepower Recommendations feature allows an FMC to use the discovery\ndata to enable or disable intrusion rules automatically to protect these\nassets."),Object(a.b)("p",null,"Organizations can run Firepower Recommendations on an on-demand basis\nafter introducing any new hosts or services into the network. Firepower\nRecommendations allow the Firepower system to tune the intrusion policy\nautomatically for efficiency and to ensure the application of the\nappropriate protection to the network. For example, if a network runs\nonly the Windows operating system, intrusion rules that address\nvulnerabilities on a Linux or Mac OS don't need to be included. However,\nif Linux is introduced into the network, network discovery would update\nthe host profiles and modify the Firepower Recommendations the next time\nit is run."),Object(a.b)("p",null,"To generate Firepower Recommendations, complete the following steps:"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 1"),": Edit the intrusion policy that will be deployed on the FTD\ndevices. The ",Object(a.b)("strong",{parentName:"p"},"Intrusion Policy Editor")," window displays."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Intrusion Policy",src:n(295).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 6:")," Generating Firepower Recommendations using an Intrusion Policy"),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 2"),": Choose ",Object(a.b)("strong",{parentName:"p"},"Firepower Recommendations")," in the left panel."),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Step 3"),": To generate recommendations only, click ",Object(a.b)("strong",{parentName:"p"},"Generate\nRecommendations")," at the bottom of the window. Alternatively, to\nincorporate the recommendations after generating them, click ",Object(a.b)("strong",{parentName:"p"},"Generate\nand Use Recommendations"),"."),Object(a.b)("p",null,"Upon generating Firepower Recommendations, a summary of the suggestions\nbecomes available for review. While the Firepower system proposes new\nrules, it also suggests disabling irrelevant intrusion rules after\nrunning the Firepower Recommendations. The relevancy of the intrusion\nrules is determined based on the network discovery data. Therefore, the\nincorporation of Firepower Recommendations can help reduce false\npositives alerts and simplify IPS policy management."),Object(a.b)("p",null,Object(a.b)("img",{alt:"Firepower Recommendations",src:n(296).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 7:")," Firepower Recommendations Suggests Disabling Unrelated\nIntrusion Rules"),Object(a.b)("h2",{id:"verificationtroubleshooting"},"Verification/Troubleshooting"),Object(a.b)("p",null,"Occasionally, the FMC may display health alerts for exceeding the\ndiscovery host/user limit. The FMC model determines the number of hosts\nand users a Firepower system can monitor."),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",{parentName:"tr",align:null},"Maximum network map size"),Object(a.b)("th",{parentName:"tr",align:"center"},"FMC 1600"),Object(a.b)("th",{parentName:"tr",align:"center"},"FMC 2600"),Object(a.b)("th",{parentName:"tr",align:"center"},"FMC 4600"),Object(a.b)("th",{parentName:"tr",align:"center"},"FMCv"),Object(a.b)("th",{parentName:"tr",align:"center"},"FMCv300"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("strong",{parentName:"td"},"Hosts")),Object(a.b)("td",{parentName:"tr",align:"center"},"50,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"150,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"600,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"50,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"150,000")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("strong",{parentName:"td"},"Users")),Object(a.b)("td",{parentName:"tr",align:"center"},"50,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"150,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"600,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"50,000"),Object(a.b)("td",{parentName:"tr",align:"center"},"150,000")))),Object(a.b)("p",null,"There are two options for handling additional hosts in a network:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"Upgrade the FMC to the next available model.")),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},"When exceeding the host limit, change the FMC behavior in the\n",Object(a.b)("strong",{parentName:"p"},"Advanced")," settings of the ",Object(a.b)("strong",{parentName:"p"},"Discover Policy")," window under the\n",Object(a.b)("strong",{parentName:"p"},"Network Discovery Data Storage Settings")," section."))),Object(a.b)("p",null,Object(a.b)("img",{alt:"Storage Settings",src:n(297).default})),Object(a.b)("p",null,Object(a.b)("strong",{parentName:"p"},"Figure 8:")," Settings in a Discovery Policy When Reaching Host Limit"),Object(a.b)("p",null,"Suppose a host runs an operating system that is not detected by the\nsystem by default or does not share identifying TCP stack\ncharacteristics. In that case, the FMC also supports the creation of\ncustom fingerprints. For more information about the Network Discover\npolicy, please read the Firepower User Guide at the following URL:\n",Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/network_discovery_policies.html"},"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/network_discovery_policies.html")),Object(a.b)("h2",{id:"summary"},"Summary"),Object(a.b)("p",null,"The network discovery feature provides deeper visibility into a network\nenvironment, allowing the Firepower administrator to take advantage of\nthe Firepower Recommendations feature to enable an FMC to automatically\noptimize its intrusion policy or use it as a tuning reference. The\ncombined network discovery and intrusion prevention functionalities save\nadministrators time through automation of policy optimization and\nreducing false positives alerts."),Object(a.b)("h2",{id:"additional-resources"},"Additional Resources"),Object(a.b)("p",null,"To learn more about the network discovery policy on Cisco Firepower\nsystem, refer to the following publications:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("a",{parentName:"p",href:"http://www.ciscopress.com/title/9781587144806"},"http://www.ciscopress.com/title/9781587144806"))),Object(a.b)("li",{parentName:"ul"},Object(a.b)("p",{parentName:"li"},Object(a.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/network_discovery_policies.html"},"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/network_discovery_policies.html")))))}b.isMDXComponent=!0}}]);