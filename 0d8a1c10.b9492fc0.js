(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var b=i.a.createContext({}),l=function(e){var t=i.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=l(e.components);return i.a.createElement(b.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=i.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,b=s(e,["components","mdxType","originalType","parentName"]),p=l(n),u=a,m=p["".concat(c,".").concat(u)]||p[u]||d[u]||r;return n?i.a.createElement(m,o(o({ref:t},b),{},{components:n})):i.a.createElement(m,o({ref:t},b))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,c=new Array(r);c[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,c[1]=o;for(var b=2;b<r;b++)c[b]=n[b];return i.a.createElement.apply(null,c)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},125:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image2-0bb4efdd3d8cf79f88373b39cd0a3f8f.png"},126:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image20-5ef46763ab5d5044c78f5a825d381e9d.png"},142:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image6-b6279db0053733fbb33252ad42a1dd40.png"},143:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image34-2c3d8b2e814e5faf619eb2f2f6e39f7e.png"},155:function(e,t,n){"use strict";n.r(t),t.default="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAXCAYAAAAV1F8QAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAhGVYSWZNTQAqAAAACAAFARIAAwAAAAEAAQAAARoABQAAAAEAAABKARsABQAAAAEAAABSASgAAwAAAAEAAgAAh2kABAAAAAEAAABaAAAAAAAAANwAAAABAAAA3AAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGqADAAQAAAABAAAAFwAAAAAP+/DJAAAACXBIWXMAACHVAAAh1QEEnLSdAAACZmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpSZXNvbHV0aW9uVW5pdD4yPC90aWZmOlJlc29sdXRpb25Vbml0PgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+NDY8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+NTE8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cn+kNEsAAAIdSURBVEgNvZTda9NQGMafnKRGVp1s/cALbQVhKtjBrrdVtl7UTirO6n/k8F9Q/AuE0W5XS/ZRUBTc3Fb1Yg5vrBsyPyqsdjVbahLfc6BQWdsl28hJICGQ9/c+z3nOKxl7+w58WAocXzhgPogRCN9AykkVOS3WS5LUsdyJQYFAABxgWRZs2z5dEFfBGEOj0cDGxw1UflVw7foNXIxEKVvtw+V5jwRElgVkde0tnjx7ikePp7D5aRN2BwiX6ck6DpEJYhh/sLyygsJsAZXKT6TGUrhyKQaZcQsdsvKwg65BTUhtr4al4hI0XUO9XsfoyCgmMhOIX47THrWHuFbEIYqioPq7Ck3TMKfPwTRNpMZTyN7JIhqJwOoSBJcg6pLJ2Pn+A8XiAuYXdNH57XQamXQG4XAEfylx3aLtCsQh5e1tFGby+PBuHUxWkMvdQ5Is6z1/QcT6KMiRIEli+PxlC9P553hfKiEYPIfJ+5NIDicR7Am6hnQF8XPydecb8jPTKK2vIRQKIZu9i1sjSahnznqCdAWZDRNvll/j1csXuDowgAe5hxhKDBJEFRPAjV0c0FySUTP+O8oiYbQP5a0y9EUd0XAUiZsJxGJxKHSG+JjxCuGwQyDxkU7cbnUX+wcHCPX1Q1VVYZUDSiBdx1ltQaIQ1WMUBq7wuCpaG+o8GchQy7ZIM93tZkprFRfvnUH082kAmj14nt7NH70+fQP9A+9v0e/nORWyAAAAAElFTkSuQmCC"},156:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image3-2bda0bbb2aca8e6b7f00df1cbd3c9198.png"},157:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image4-e766b38fed74d08f7590e283521ad496.png"},158:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image5-29b192241d4b2070c41d56977ece8e42.png"},159:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image7-2807deb21c5ff7e81b61279d3bb8c438.png"},160:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image8-64c6e76a2c6e196d405dd08339962974.png"},161:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image9-48fd24850e0104c9877dc38ef2927747.png"},162:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image10-2cb5498451398eb15576ff4946eaecde.png"},163:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image11-27a30593b6b722ef34aad9782635694d.png"},164:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image12-3fe0cf987185a592c4b8489c3f6cc99a.png"},165:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image13-16ccf81a8bca89dcb4d491203237cc91.png"},166:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image14-486f63003a7bea6c3f9dceb7a5a0cc36.png"},167:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image15-09e7afb7c2dbb4c5ba4c7adc12833d31.png"},168:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image16-546375181ac596b1bf77db9c7acbf2c1.png"},169:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image17-cc6c31a6ced69ce045f331cdafb804db.png"},170:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image18-21b9dd607a841e08d185311a543d3999.png"},171:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image19-0d225b7287a52e901ee38465ad939283.png"},172:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image21-0b3f606eb5a5a5fdfb75377380bd639f.png"},173:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image22-12348ba82dc96a276aeb032487771ca4.png"},174:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image23-4ca79beec7ea3de961068d69e590ebf2.png"},175:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image24-d9bc4ca6a4dcc7c424215799858cfa41.png"},176:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image25-ed4c00ad4b285d6fb9826ccf6341c502.png"},177:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image26-a8068cb32c806bac7ed93513b1d5554b.png"},178:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image27-5f8c823ce532e8adfd00d061e2d1423c.png"},179:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image28-6a3ca71f65ef75931b853d2b3f6a8a94.png"},180:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image29-40a473b3abfa8b69000cde74ef5ba3da.png"},181:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image30-55c11a8e6498fc70ab1e225f49278770.png"},182:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image31-c44f768e71c58e1ab576d2f574fe2c5e.png"},183:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image32-00d682f537cfaa72fbdc80abaff5756e.png"},184:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image33-6eb6ad04f655b7b3f9397d6787502112.png"},185:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image35-52ef3d6bb948ba69ea6190e1573f15f0.png"},186:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image36-8416dbc9e9b56f3f88fec7fdba33e1f3.png"},187:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image37-39a56440c0c01c1f214cd028ec13e1cf.png"},188:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image38-78f1c5d7cf2e2eac26b8fc3c4ba360eb.png"},189:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image39-a04f24a095e4596d4775df21c549a64c.png"},190:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/image40-9c26ce8817776f93083a3a04c517f83b.png"},71:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return s})),n.d(t,"toc",(function(){return b})),n.d(t,"default",(function(){return p}));var a=n(3),i=n(7),r=(n(0),n(101)),c=["components"],o={id:"vrf",title:"Virtual Routing and Forwarding",description:"Configuring VRF on Secure Firewall",hide_table_of_contents:!1},s={unversionedId:"vrf",id:"vrf",isDocsHomePage:!1,title:"Virtual Routing and Forwarding",description:"Configuring VRF on Secure Firewall",source:"@site/docs/SF_VRF.md",slug:"/vrf",permalink:"/securefirewallessentials/docs/vrf",editUrl:"https://securefirewallessentials.github.io/docs/SF_VRF.md",version:"current",sidebar:"firstSidebar",previous:{title:"SNMP Monitoring",permalink:"/securefirewallessentials/docs/snmp"},next:{title:"Secure IPS",permalink:"/securefirewallessentials/docs/sips-wp"}},b=[{value:"Introduction",id:"introduction",children:[]},{value:"Configuration",id:"configuration",children:[{value:"Firepower Management Center",id:"firepower-management-center",children:[]},{value:"Firepower Device Manager",id:"firepower-device-manager",children:[]}]},{value:"Multi-Instance with VRF",id:"multi-instance-with-vrf",children:[]},{value:"How do policies interact with VRF",id:"how-do-policies-interact-with-vrf",children:[{value:"Overlapping IP addresses",id:"overlapping-ip-addresses",children:[]},{value:"Limitations",id:"limitations",children:[]}]},{value:"How NAT interacts with VRF",id:"how-nat-interacts-with-vrf",children:[{value:"Route Leaking using NAT",id:"route-leaking-using-nat",children:[]},{value:"Overlapping IP addresses",id:"overlapping-ip-addresses-1",children:[]}]},{value:"Verification and Troubleshooting",id:"verification-and-troubleshooting",children:[{value:"Number of Supported VRFs per Platform",id:"number-of-supported-vrfs-per-platform",children:[]}]},{value:"Summary",id:"summary",children:[]}],l={toc:b};function p(e){var t=e.components,o=Object(i.a)(e,c);return Object(r.b)("wrapper",Object(a.a)({},l,o,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"May 22, 2021"),Object(r.b)("h2",{id:"introduction"},"Introduction"),Object(r.b)("p",null,"The Virtual Routing and Forwarding (VRF) feature was added in Firepower\nThreat Defense (FTD) software release 6.6 to allow for segregation of\nrouting tables. Also, VRF allows network segments with overlapping IP\naddress spaces. VRF implementation on FTD is akin to VRF-lite on Cisco\nrouters. You can also use VRFs for routing plane separation during\nmigration from multi-context ASAs to FTD."),Object(r.b)("h2",{id:"configuration"},"Configuration"),Object(r.b)("p",null,"Using VRF, we can separate the NGFW/NGIPS functions for different\nrouting domains across an enterprise network. Also, it allows for\noverlapping address space to co-exist and communicate through the FTD."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"The FMC and FDM UI refer to a VRF as Virtual Router. These terms\nwill be used interchangeably."))),Object(r.b)("h3",{id:"firepower-management-center"},"Firepower Management Center"),Object(r.b)("p",null,"This section showcases the configuration steps using\nFirepower Management Center."),Object(r.b)("h4",{id:"creating-a-vrf"},"Creating a VRF"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," Choose ",Object(r.b)("strong",{parentName:"p"},"Devices ",">"," Devices Management"),". Click on the ",Object(r.b)("img",{src:n(155).default}),"\nicon against the FTD you wish to configure for VRFs."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click on the ",Object(r.b)("strong",{parentName:"p"},"Routing")," tab."),Object(r.b)("p",null,Object(r.b)("img",{src:n(125).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," Click ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual Routers.")," Notice that all the interfaces\nare assigned to the ",Object(r.b)("strong",{parentName:"p"},"Global")," VRF, which is the default configuration."),Object(r.b)("p",null,Object(r.b)("img",{src:n(125).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"Under ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual Routers"),", there is a dropdown menu to\nselect a VRF. After creating a new VRF, use this to select that VRF and\nconfigure settings within the VRF, such as interface assignments, static\nand dynamic routing."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," Click ",Object(r.b)("strong",{parentName:"p"},"+ Add Virtual Router")),Object(r.b)("p",null,Object(r.b)("img",{src:n(125).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Enter the VRF name and description. Click ",Object(r.b)("strong",{parentName:"p"},"OK"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(156).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"Verify the VRF name before assigning interfaces to the VRF. The\nFMC does not allow editing the name of the VRF once it is created. If\nyou wish to change the VRF name, you need to click on ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual\nRouters,")," delete the VRF and recreate the VRF with the correct name."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 6:")," Now, you will be redirected to the ",Object(r.b)("strong",{parentName:"p"},"Virtual Router Properties"),"\npage with the newly created VRF selected in the dropdown menu. Select\nthe interface/s from the ",Object(r.b)("strong",{parentName:"p"},"Available Interfaces")," and click ",Object(r.b)("strong",{parentName:"p"},"Add.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(157).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},Object(r.b)("strong",{parentName:"p"},"Available Interfaces")," only the interfaces configured with a\nlogical name and not assigned to another user-defined VRF."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 7:")," You can repeat Steps 3 to 6 for adding more VRFs."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 8:")," Remember to save the changes after adding the VRFs. ",Object(r.b)("img",{src:n(158).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 9:")," Deploy from the FMC if you are not making any more configuration\nchanges."),Object(r.b)("h4",{id:"configure-static-routes-for-vrf"},"Configure Static Routes for VRF"),Object(r.b)("p",null,"You can use Static routes for intra VRF routing or to leak routes into\nother user-defined VRFs or the global VRF. When selecting an interface\nfor the static route, the FMC shows the VRF that the interface belongs\nto."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," Select the VRF from the dropdown menu under ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual\nRouters.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(142).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click on ",Object(r.b)("strong",{parentName:"p"},"Static Route.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(159).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," Click on ",Object(r.b)("strong",{parentName:"p"},"Add Route.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(160).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," Select ",Object(r.b)("strong",{parentName:"p"},"IPv4")," or ",Object(r.b)("strong",{parentName:"p"},"IPv6")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Select an interface from the interface dropdown list"),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"FMC shows the VRF assignment of each interface. Interfaces that\nare part of Global VRF have the word ",Object(r.b)("strong",{parentName:"p"},"Global")," shown against them. For\nroute leaking, don't specify the next hop."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 6:")," Select Network from the ",Object(r.b)("strong",{parentName:"p"},"Available Network")," dropdown list.\nClick ",Object(r.b)("strong",{parentName:"p"},"Add")," to populate the table named ",Object(r.b)("strong",{parentName:"p"},"Selected Network"),"."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 7:")," Select next hop from the ",Object(r.b)("strong",{parentName:"p"},"Gateway")," dropdown list. If leaking\nroutes, leave this blank."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 8:")," Click ",Object(r.b)("strong",{parentName:"p"},"OK.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(161).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 9:")," Click ",Object(r.b)("strong",{parentName:"p"},"Save")," to save the changes to the VRF configuration."),Object(r.b)("p",null,Object(r.b)("img",{src:n(162).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"You must leak the route in the reverse direction as well if the\ntraffic is not matching any inspection rules such as ICMP inspection. If\nthe Gateway objects don't exist, you can create a new object from the\nroute configuration window."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 10:")," Deploy from FMC if you are not making any more configuration\nchanges."),Object(r.b)("h4",{id:"configure-ospf-for-vrf"},"Configure OSPF for VRF"),Object(r.b)("p",null,"FTD supports OSPFv2 for user-defined VRFs and OSPFv2/v3 for Global VRFs."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," Select the VRF from the dropdown menu under ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual\nRouters.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(142).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click on ",Object(r.b)("strong",{parentName:"p"},"OSPF.")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," Check the ",Object(r.b)("strong",{parentName:"p"},"Process 1")," checkbox."),Object(r.b)("p",null,Object(r.b)("img",{src:n(163).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"The Process ID is pre-filled and cannot be changed. FTD allows 2\nOSPF processes per VRF. The numbers 1 and 2 are reserved for the OSPF\nProcess IDs in global VRF. The next two numbers, 3 and 4, are allocated\nto the two OSPF Process IDs in the first user-defined VRFs. This\nincremental pattern continues whenever OSPF is enabled in the next\nuser-defined VRF."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," The rest of the OSPF configuration is similar to a non-VRF aware\nOSPF configuration."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},Object(r.b)("strong",{parentName:"p"},"Interface"),"\xa0allows you to select only the interfaces of the\nvirtual router that you are configuring.\xa0OSPFv3 configuration is\navailable only in the Global VRF."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Deploy from FMC if you are not making any more configuration\nchanges."),Object(r.b)("h4",{id:"configure-bgp-for-vrf"},"Configure BGP for VRF"),Object(r.b)("p",null,"All VRFs share a single BGP process with each VRF as an address family\nwithin that process. That is why the BGP configuration is split into two\nsteps. There are general settings (e.g. AS number) and per user-defined\nVRF settings."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," In the same column as the ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual Routers"),", click on\n",Object(r.b)("strong",{parentName:"p"},"BGP")," under ",Object(r.b)("strong",{parentName:"p"},"General Settings")," (Irrespective of the VRF selected\nunder Manage Virtual Routers)."),Object(r.b)("p",null,Object(r.b)("img",{src:n(164).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Check the checkbox named ",Object(r.b)("strong",{parentName:"p"},"Enable BGP.")," Enter the AS number."),Object(r.b)("p",null,Object(r.b)("img",{src:n(165).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," Configure the rest of the BGP General Settings."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," Select a VRF from the dropdown menu under ",Object(r.b)("strong",{parentName:"p"},"Manage Virtual\nRouters.")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Click ",Object(r.b)("strong",{parentName:"p"},"BGP.")," Configure the BGP settings specific to the\nselected VRF."),Object(r.b)("p",null,Object(r.b)("img",{src:n(166).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"You cannot change all the global BGP settings within User-defined\nVRFs. However, you can override the router-Id within each VRF. The rest\nof the BGP configuration is similar to non-VRF aware BGP configuration."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 6:")," Click ",Object(r.b)("strong",{parentName:"p"},"IPv4")," under ",Object(r.b)("strong",{parentName:"p"},"BGP.")," Click on ",Object(r.b)("strong",{parentName:"p"},"Enable IPv4."),"\nConfigure the IPv4 address family settings."),Object(r.b)("p",null,Object(r.b)("img",{src:n(167).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"User-defined VRFs support BGP IPv4 address family, whereas Global\nVRFs BGP configuration supports IPv4 and IPv6 address families."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 7:")," Deploy from FMC if you are not making any more configuration\nchanges."),Object(r.b)("h3",{id:"firepower-device-manager"},"Firepower Device Manager"),Object(r.b)("p",null,"This section showcases the configuration steps using the Firepower\nDevice Manager. Release 6.6 the BGP and OSPF configurations from\nAdvanced Settings to Routing."),Object(r.b)("h4",{id:"creating-a-vrf-1"},"Creating a VRF"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," Click ",Object(r.b)("strong",{parentName:"p"},"View Configuration")," under Routing section."),Object(r.b)("p",null,Object(r.b)("img",{src:n(168).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click on the dropdown named ",Object(r.b)("strong",{parentName:"p"},"Add Multiple Virtual Routers."),"\nClick on ",Object(r.b)("strong",{parentName:"p"},"Create First Custom Virtual Router"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(169).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," Enter the details such as VRF name, description. Under\n",Object(r.b)("strong",{parentName:"p"},"Interfaces"),", click on the ",Object(r.b)("strong",{parentName:"p"},"+")," icon and select the interface/s for\nthis VRF and click ",Object(r.b)("strong",{parentName:"p"},"OK.")," Click ",Object(r.b)("strong",{parentName:"p"},"OK")," again to save the VRF\nconfiguration."),Object(r.b)("p",null,Object(r.b)("img",{src:n(170).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," Now, you will see the newly created VRF along with the Global\nVRF."),Object(r.b)("p",null,Object(r.b)("img",{src:n(171).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"By default, all the interfaces are assigned to the Global VRF."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," You can edit the various VRF properties like the VRF name,\ndescription and interface assignments. Click on the ",Object(r.b)("strong",{parentName:"p"},"view")," icon and\nthen click on the tab named ",Object(r.b)("strong",{parentName:"p"},"Virtual Router Properties.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(126).default})),Object(r.b)("p",null,Object(r.b)("img",{src:n(172).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 6:")," Click on the ",Object(r.b)("strong",{parentName:"p"},"+")," icon to add and configure more VRFs."),Object(r.b)("p",null,Object(r.b)("img",{src:n(173).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 7:")," You can toggle between different VRFs after configuring a VRF."),Object(r.b)("p",null,Object(r.b)("img",{src:n(174).default})),Object(r.b)("h4",{id:"configure-static-routes-for-vrf-1"},"Configure Static Routes for VRF"),Object(r.b)("p",null,"You can use Static routes for intra VRF routing or to leak connected or\nstatic routes into other user-defined VRFs or the global VRF. When you\nselect the static route interface, FDM will warn that the routes will be\nleaked."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," Select the VRF of choice and view the VRF properties by clicking\nthe ",Object(r.b)("strong",{parentName:"p"},"view")," icon. The ",Object(r.b)("strong",{parentName:"p"},"Static Routing")," is auto selected."),Object(r.b)("p",null,Object(r.b)("img",{src:n(126).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click on ",Object(r.b)("strong",{parentName:"p"},"Create Static Route"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(175).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," Enter ",Object(r.b)("strong",{parentName:"p"},"Name")," and ",Object(r.b)("strong",{parentName:"p"},"Description"),". ",Object(r.b)("img",{src:n(176).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," From the ",Object(r.b)("strong",{parentName:"p"},"Interface")," dropdown menu, select an interface. The\nUI shows the VRF the interface belongs to. If the interface belongs to a\ndifferent VRF, the UI warns about the route being leaked."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Select ",Object(r.b)("strong",{parentName:"p"},"IPv4")," or ",Object(r.b)("strong",{parentName:"p"},"IPv6"),". Select the ",Object(r.b)("strong",{parentName:"p"},"Networks")," by clicking\non the + icon. Specify the Gateway from the dropdown. If configuring\nroute leak, leave the gateway blank. Click ",Object(r.b)("strong",{parentName:"p"},"OK"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(177).default})),Object(r.b)("h4",{id:"configure-ospf-for-vrf-1"},"Configure OSPF for VRF"),Object(r.b)("p",null,"FTD supports OSPFv2 for user-defined VRFs and OSPFv2/v3 for Global VRFs."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," From the VRF settings page, select ",Object(r.b)("strong",{parentName:"p"},"OSPF")," tab."),Object(r.b)("p",null,Object(r.b)("img",{src:n(178).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click ",Object(r.b)("strong",{parentName:"p"},"CREATE OSPF OBJECT")," and select ",Object(r.b)("strong",{parentName:"p"},"OSFP"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(179).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," You will see the SMART CLI interface for OSPF routing\nconfiguration. By default, it shows only the OSPF process ID and\nadjacency change log settings. Click on ",Object(r.b)("strong",{parentName:"p"},"Show disabled (")," it will\nchange to Hide disabled ) to view more settings."),Object(r.b)("p",null,Object(r.b)("img",{src:n(180).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," Enter the name for the OSPF object and provide other details. To\nenable and edit certain lines, click the ",Object(r.b)("strong",{parentName:"p"},"+")," on the left."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Click ",Object(r.b)("strong",{parentName:"p"},"OK"),"."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"FTD allows 2 OSPF processes per VRF."))),Object(r.b)("p",null,Object(r.b)("img",{src:n(181).default})),Object(r.b)("h4",{id:"configure-bgp-for-vrf-1"},"Configure BGP for VRF"),Object(r.b)("p",null,"All VRFs share a single BGP process with each VRF as an address family\nwithin that process. That is why the BGP configuration is split into two\nsteps. There are general settings (e.g. AS number) and per user-defined\nVRF settings. Configure BGP Global Settings only if configuring BGP in a\nVRF."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 1:")," From the Routing page, click on ",Object(r.b)("strong",{parentName:"p"},"BGP Global Settings"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(182).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 2:")," Click on ",Object(r.b)("strong",{parentName:"p"},"CREATE BGP GLOBAL SETTINGS OBJECT.")),Object(r.b)("p",null,Object(r.b)("img",{src:n(183).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"You will see this popup only when configuring BGP Global Settings\nfor the first time."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 3:")," You will see the SMART CLI interface for BGP Global routing\nconfiguration. The name is pre-filled with ",Object(r.b)("strong",{parentName:"p"},"BgpGeneralSettings")," and\ncan be edited. Enter the BGP configuration, such as the AS number,\namongst others. Click on ",Object(r.b)("strong",{parentName:"p"},"Show disabled")," to view more settings. Click\n",Object(r.b)("strong",{parentName:"p"},"OK"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(184).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 4:")," Now, click on the ",Object(r.b)("strong",{parentName:"p"},"View")," icon for the VRF to configure for\nBGP. Select the ",Object(r.b)("strong",{parentName:"p"},"BGP")," tab."),Object(r.b)("p",null,Object(r.b)("img",{src:n(126).default})),Object(r.b)("p",null,Object(r.b)("img",{src:n(143).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 5:")," Click on ",Object(r.b)("strong",{parentName:"p"},"CREATE BGP OBJECT"),"."),Object(r.b)("p",null,Object(r.b)("img",{src:n(143).default})),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 6:")," You will see the SMART CLI interface for BGP routing\nconfiguration. Click on ",Object(r.b)("strong",{parentName:"p"},"Show disabled")," to view more settings. Enter\n",Object(r.b)("strong",{parentName:"p"},"Name")," and Description. Provide the ",Object(r.b)("strong",{parentName:"p"},"as-number")," and ",Object(r.b)("strong",{parentName:"p"},"ip-protocol"),"\ninformation."),Object(r.b)("p",null,Object(r.b)("img",{src:n(185).default})),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"The as-number should match the one defined in the BGP Global\nSettings Object. The ip-protocol can be IPv4 only as user-defined VRFs\nsupport BGP IPv4 address family only. Global VRFs BGP configuration\nsupports both IPv4 and IPv6 address families. Creating the BGP object\nwithin a VRF without creating the BGP Global Configuration Settings\nobject creates the BGP Global Configuration Settings object\nautomatically."))),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Step 7:")," Deploy the changes."),Object(r.b)("h2",{id:"multi-instance-with-vrf"},"Multi-Instance with VRF"),Object(r.b)("p",null,"VRF configuration remains the same when using multi-instance on the\nFirepower platforms. However, the number of VRFs in an instance depends\non the number of cores allocated to that instance and are calculated as\nfollows:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"VRF_INSTANCE = (MAX_VRF_PLATFORM / MAX_CORES_PLATFORM) \\*\n(CORES_IN_INSTANCE)\n")),Object(r.b)("p",null,"Let's use the example of FP9300 SM-36 module to calculate the number of\nVRFs in an instance. This platform supports a maximum of 70 cores and\n100 VRFs. Here is the calculation for the VRFs in an instance with 20\ncores:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"(100/70)\\*20 = 28 ( We use the value rounded down after calculation )\n")),Object(r.b)("h2",{id:"how-do-policies-interact-with-vrf"},"How do policies interact with VRF"),Object(r.b)("p",null,"Assigning the interfaces to different VRFs segments the routing table.\nHowever, the Security Policies consider the interface's Security Zone,\nwhich implies that the policy evaluation is not VRF aware by default."),Object(r.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(r.b)("div",{parentName:"div",className:"admonition-heading"},Object(r.b)("h5",{parentName:"div"},Object(r.b)("span",{parentName:"h5",className:"admonition-icon"},Object(r.b)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},Object(r.b)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),Object(r.b)("div",{parentName:"div",className:"admonition-content"},Object(r.b)("p",{parentName:"div"},"The Security Intelligence policy is not VRF aware. If an IP\naddress, domain or URL is blocked as part of Security Intelligence, it\nwill be blocked across all the VRFs."))),Object(r.b)("p",null,'E.g. If you create a rule with the source zone as "any," it will be\nmatched to traffic originating from all interfaces across all VRFs.'),Object(r.b)("p",null,"For applying policies based on VRF, you need to assign the same Security\nZone to all the interfaces from a VRF and then use that Security Zone in\nthe security policy."),Object(r.b)("h3",{id:"overlapping-ip-addresses"},"Overlapping IP addresses"),Object(r.b)("p",null,"VRFs create mutually exclusive routing tables, enabling FTD to allow\noverlapping or same address spaces across different VRFs. While creating\na security policy, we need to be aware of overlapping IP subnets."),Object(r.b)("p",null,"E.g. IP subnet 192.168.1.0/24 exists in VRF-A and VRF-B. The network\nadministrators requires users in VRF-A to have Internet access and users\nin VRF-B to not have Internet access. If you create a security policy\nthat allows Internet access based solely on the source IP network, you\nwill inadvertently allow access to the Internet from both VRFs. You need\nto assign the interfaces belonging to VRF-A and VRF-B in different\nSecurity Zones. Use the Security Zone assigned to the VRF-A interfaces\nand the source IP network to allow Internet access."),Object(r.b)("h3",{id:"limitations"},"Limitations"),Object(r.b)("p",null,"Identity policies require different realms per VRF and different ISE\nconnections per VRF to segregate the user-IP and SGT-IP mappings per\nVRF."),Object(r.b)("p",null,"Features such as Threat Intelligence Director (TID), Host Profiling and\nMalware Trajectory rely on the FMC to map the network. Overlapping IP\naddresses make it impossible to differentiate when the same IP address\nbelongs to two different hosts. When an overlapping IP segment exists on\nthe same device across multiple VRFs, the analysis from these features\nis not accurate."),Object(r.b)("h2",{id:"how-nat-interacts-with-vrf"},"How NAT interacts with VRF"),Object(r.b)("p",null,"FTD uses NAT and/or a routing table for selecting the egress interface\nand the next hop adjacency resolution. NAT can be used to leak routes\nacross two VRFs and also as a way of enabling communication between\noverlapping subnets."),Object(r.b)("h3",{id:"route-leaking-using-nat"},"Route Leaking using NAT"),Object(r.b)("p",null,"If you configure NAT rules with the source and destination interfaces in\ndifferent VRFs, it will allow the traffic to pass from one VRF to\nanother. However, suppose you do not specify the route lookup option. In\nthat case, the NAT configuration determines the egress interface and the\ntraffic will be sent to the VRF mapped to the destination interface\nwithout validating if the destination VRF has a route. We recommended\nusing static routes for route leaking along with a NAT policy\nconfiguration."),Object(r.b)("p",null,Object(r.b)("img",{src:n(186).default})),Object(r.b)("h3",{id:"overlapping-ip-addresses-1"},"Overlapping IP addresses"),Object(r.b)("p",null,Object(r.b)("img",{src:n(187).default})),Object(r.b)("p",null,"If a NAT rule is applied to VRFs with overlapping IP address spaces,\nensure that the source interface is specified in a NAT rule for each\nVRF, ideally along with separate NAT/PAT pools. Using 'any' in the\nsource interface causes reverse translation to fail. Even without\noverlapping IP addresses, it is highly recommended to use specific\ninterface definitions in the NAT rules."),Object(r.b)("p",null,"NAT can enable overlapping subnets to communicate with each other,\nwithout using BVIs or another network hop as shown in this example:"),Object(r.b)("p",null,Object(r.b)("img",{src:n(188).default})),Object(r.b)("h2",{id:"verification-and-troubleshooting"},"Verification and Troubleshooting"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"show vrf -- the command will show the configured VRFs and their\ninterface assignments.\n")),Object(r.b)("p",null,Object(r.b)("img",{src:n(189).default})),Object(r.b)("p",null,"VRF specific routing information can be viewed using the below commands:"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},"show route \\[vrf name\\]\n\nshow ospf \\[ vrf name \\| all\\]\n\nshow bgp \\[ vrf name \\| all\\]\n")),Object(r.b)("p",null,"A special SI route flag shows leaked routes in the routing table."),Object(r.b)("p",null,Object(r.b)("img",{src:n(190).default})),Object(r.b)("h3",{id:"number-of-supported-vrfs-per-platform"},"Number of Supported VRFs per Platform"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",{parentName:"tr",align:null},"Firepower Platform"),Object(r.b)("th",{parentName:"tr",align:null},"VRF Limit"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"1010"),Object(r.b)("td",{parentName:"tr",align:null},"N/A")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"1120"),Object(r.b)("td",{parentName:"tr",align:null},"5")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"1140, 1150, 2110, 5508, 5516, 5525\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"10")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"2120, 5545, 5555\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"20")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"2130, FTDv\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"30")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"2140\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"40")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"4110, 4112\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"60")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"4115, 4120\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"80")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"4125, 4140, 4145, 4150, 9300 SM-24/36/40/44/48/56 (per-blade)\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"100")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:null},"9300 with fully populated blades (3x SM)\u200b"),Object(r.b)("td",{parentName:"tr",align:null},"300")))),Object(r.b)("h2",{id:"summary"},"Summary"),Object(r.b)("p",null,"VRF combined with multi-instance can provide true multi-tenancy through\nrouting, security policy and management plane separation. More detailed\ninformation about VRF is available in the configuration guides for\n",Object(r.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/configuration/guide/fpmc-config-guide-v66/virtual-routing-for-firepower-threat-defense.html"},"FMC"),"\nand\n",Object(r.b)("a",{parentName:"p",href:"https://www.cisco.com/c/en/us/td/docs/security/firepower/660/fdm/fptd-fdm-config-guide-660/fptd-fdm-virtual-routers.html"},"FDM"),"."))}p.isMDXComponent=!0}}]);